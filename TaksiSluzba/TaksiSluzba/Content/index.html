<!DOCTYPE html>
<html>


<head>
    <link rel="stylesheet" type="text/css" href="Stilovi.css" />
    <link rel="stylesheet" href="https://openlayers.org/en/v4.1.0/css/ol.css" type="text/css">
    <script src="https://openlayers.org/en/v4.1.0/build/ol.js"></script>



    <meta charset="utf-8" />
    <title></title>


    <script src="/Scripts/jquery-1.10.2.js"></script>
    <script>
        $(document).ready(function () {

            // Svuda napravi ono za refresh

            var trenutnoUlogovan; // trenutno ulogovan treba svuda da se zameni sa session storage user
           // var UserMenu;
           // var UserView;

            //var pomocVozaci = "";
            //
            var map = "<div id=\"map\" style=\"height:400px; text-align: center; width:50%\" class=\"map\"></div><script>";
            map += "var xx; var yy; var ulica_broj; var grad;";
            map += "function reverseGeocode(coords) {";
            map += "fetch('http://nominatim.openstreetmap.org/reverse?format=json&lon=' + coords[0] + '&lat=' + coords[1])";
            map += ".then(function(response) {return response.json();}).then(function(json) {var add = json.address;";
            map += "ulica_broj = add.road; if(add.house_number != null){ulica_broj += \" \"+add.house_number;}grad = add.city + \" \" + add.postcode; $(\"#kord\").html(ulica_broj +\" , \"+ grad);});}";
            map += "var map = new ol.Map({layers: [new ol.layer.Tile({";
            map += "source: new ol.source.OSM()})],target: 'map',view: new ol.View({";
            map += "center: [2209717.3810248757,5660306.884676355],zoom: 19})});";
            map += "map.on('dblclick', function (evt) {var coord = ol.proj.toLonLat(evt.coordinate); reverseGeocode(coord);";
            map += " xx = coord[0]; yy = coord[1];});";
            map += "<\/script>";
            //

            if (sessionStorage.getItem("trenutniPrikaz") != null) {
                $("#PageContent").html(sessionStorage.getItem("trenutniPrikaz"));
            }

            if (sessionStorage.getItem("trenutniMeni") != null) {
                $("#PageMenu").html(sessionStorage.getItem("trenutniMeni"));
            }

            if (sessionStorage.getItem("ulogovaniKorisnik") != null) {
                trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));
            }

            $(document).on("dblclick", "#map", function () {
                if (xx != null && yy != null) {
                    var coords = {
                        x: xx,
                        y: yy
                    };
                    $.get("/api/ahome/najblizi", coords, function (data, status) {
                        var nesto = eval(data);
                        var pom = "";
                        for (var k in nesto) {
                            pom += "<option value=\"" + k + "\">" + nesto[k] + "</option>";
                        }
                        var pomocVozaci = pom;
                        sessionStorage.setItem("najblizivozaci", pomocVozaci);
                        $("#vozaci").html(pom);
                    });
                }


            });

            $(document).on("click", "#logovanje", function () {

                var UserView = "";

                $("#Greske").empty();
                $("#AllGood").empty();

                UserView = "<table>";
                UserView += "    <tr>";
                UserView += "        <td> Korisničko ime </td>";
                UserView += "        <td> <input type=\"text\" id=\"Username\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> Lozinka </td>";
                UserView += "        <td> <input type=\"password\" id=\"Password\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> <input type=\"button\" value=\"Uloguj se\" id=\"logovanjeButton\" /></td>";
                UserView += "    </tr>";
                UserView += "</table>";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#logovanjeButton", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserMenu="";
                var UserView="";

                if ($("#Username").val() != "" && $("#Password").val() != "") {
                    var objekat = { Username: $("#Username").val(), Password: $("#Password").val() };
                    $.get("/api/ahome/login", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan)); //  sessionStorage.removeItem("ulogovaniKorisnik");
                            sessionStorage.setItem("ulogovaniId", data.Id);

                            if (data.Uloga == 0) {
                                // KORISNIK
                                UserView = " <br/> ";
                                UserView += "    <table border=\"1\">";
                                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"3\"> </th> </tr>";

                                for (v in data.Voznje) {
                                    // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija + "  </td > <td> " + data.Voznje[v].Name + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                                    UserView += "<tr> <td> " + data.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + data.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";
                                    if (data.Voznje[v].Odrediste == null) { UserView += "<td>"+""+"</td>"; }
                                    else { UserView += "<td>" + data.Voznje[v].Odrediste + " </td> " }

                                    UserView += "<td>" + data.Voznje[v].Musterija + "  </td >";

                                    if (data.Voznje[v].Vozac == null || data.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                                    else { UserView += "<td>" + data.Voznje[v].Vozac + " </td> " }

                                    if (data.Voznje[v].Dispatcher == null || data.Voznje[v].Dispatcher=="") { UserView += "<td>"+" "+"</td>"; }
                                    else { UserView += "<td>" + data.Voznje[v].Dispatcher + " </td> " }

                                    var ponistiDugme = "<td> </td>";
                                    var pomstat = "";

                                    //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                                    if (data.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat ="KREIRANA" ;ponistiDugme = "<td> <input type=\"submit\" id="+data.Voznje[v].Id+" name=\"ponistiVoznjuKorisnik\" value=\"Ponisti\"/></td>"; }
                                    if (data.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA";  }
                                    if (data.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                                    if (data.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA";  }
                                    if (data.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                                    if (data.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA";  }
                                    if (data.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                                    if (data.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU";}

                                    //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                                    UserView += "<td> <input type=\"submit\" value=\"Izmeni\" name=\"korisnikMenjaVoznju\"  id=" + data.Voznje[v].Id + "_" + pomstat + " /> </td> <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + data.Voznje[v].Id+" /> </td>" + ponistiDugme +"</tr > ";

                                }
                                UserView += "    </table>";
                                UserView += " <p> Pretraga po statusu </p>";
                                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                                UserView += "   <option value=\"0\">KREIRANA</option>";
                                UserView += "    <option value=\"1\">FORMIRANA</option>";
                                UserView += "    <option value=\"2\">OBRADJENA</option>";
                                UserView += "    <option value=\"3\">PRIHVACENA</option>";
                                UserView += "    <option value=\"4\">OTKAZANA</option>";
                                UserView += "    <option value=\"5\">NEUSPESNA</option>";
                                UserView += "    <option value=\"6\">USPESNA</option>";
                                UserView += "    <option value=\"7\">U_TOKU</option>";
                                UserView += "</select> <br/> <br/>";

                                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                                UserView += "    <br/> Pretražite po datumu <br/> ";

                                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                                UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                                UserView += "     <br/>Pretražite po oceni <br/> ";
                                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "        <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "         <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                                UserView += "   <p> <br/>Pretraga po ceni </p>";
                                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                                UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcije\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profil\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"novaVoznjaKorisnik\"> Nova vožnja </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";


                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                sessionStorage.setItem("trenutniMeni", UserMenu);

                                $("#PageContent").html(UserView);
                                $("#PageMenu").html(UserMenu);

                            }
                            else if (data.Uloga == 1) {
                                //  DRIVER

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcijeVozaca\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profilVozaca\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"promenaLokacije\"> Promena Lokacije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";
                                //
                                UserView = "<h2> Vožnje </h2> ";
                                UserView += "    <table border=\"1\">";
                                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th> </th> <th> </th> </tr>";

                                for (v in data.Voznje) {
                                    //UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija + "  </td > <td> " + data.Voznje[v].Name + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                                    UserView += "<tr> <td> " + data.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + data.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";
                                    //if (data.Voznje[v].Odrediste == null) { UserView += "<td>" + "" + "</td>"; }
                                    //else { UserView += "<td>" + data.Voznje[v].Odrediste + " </td> " }

                                    if (data.Voznje[v].Odrediste != null) {
                                        if (data.Voznje[v].Odrediste.Adresa != null) {
                                            if (data.Voznje[v].Odrediste.Adresa.UlicaBroj != null) {
                                                UserView += " <td> " + data.Voznje[v].Odrediste.Adresa.UlicaBroj + " ";
                                            }
                                            else { UserView += "<td> "; }
                                            if (data.Voznje[v].Odrediste.Adresa.MestoPostanski != null) {
                                                UserView += data.Voznje[v].Odrediste.Adresa.MestoPostanski + " </td>";
                                            } else {
                                                UserView += " </td>";
                                            }
                                        } else { UserView += "<td></td >"; }
                                    } else { UserView += "<td></td >";}

                                    //UserView += "<td>" + data.Voznje[v].Musterija + "  </td >";

                                    if (trenutnoUlogovan.Voznje[v].Musterija != null) {
                                        UserView += "<td>" + trenutnoUlogovan.Voznje[v].Musterija + "  </td >";
                                    } else {
                                        UserView += "<td></td >";
                                    }

                                    if (data.Voznje[v].Vozac == null || data.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                                    else { UserView += "<td>" + data.Voznje[v].Vozac + " </td> " }

                                    if (data.Voznje[v].Dispatcher == null || data.Voznje[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                                    else { UserView += "<td>" + data.Voznje[v].Dispatcher + " </td> " }

                                    var ponistiDugme = "<td> </td>";
                                    var pomstat = "";

                                    //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                                    if (data.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; ponistiDugme = "<td> <input type=\"submit\" id=" + data.Voznje[v].Id + " name=\"ponistiVoznjuKorisnik\" value=\"Ponisti\"/></td>"; }
                                    if (data.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; }
                                    if (data.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                                    if (data.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                                    if (data.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                                    if (data.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                                    if (data.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                                    if (data.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                                    //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                                    UserView += "<td> <input type=\"submit\" value=\"Izmeni\" name=\"vozacMenjaVoznju\"  id=" + data.Voznje[v].Id + "_" + pomstat + " /> </td> <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + data.Voznje[v].Id + " /> </td>"  + "</tr > ";


                                }
                                UserView += "    </table>";
                                UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>";
                                UserView += " <p> Pretraga po statusu </p>";
                                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                                UserView += "   <option value=\"0\">KREIRANA</option>";
                                UserView += "    <option value=\"1\">FORMIRANA</option>";
                                UserView += "    <option value=\"2\">OBRADJENA</option>";
                                UserView += "    <option value=\"3\">PRIHVACENA</option>";
                                UserView += "    <option value=\"4\">OTKAZANA</option>";
                                UserView += "    <option value=\"5\">NEUSPESNA</option>";
                                UserView += "    <option value=\"6\">USPESNA</option>";
                                UserView += "    <option value=\"7\">U_TOKU</option>";
                                UserView += "</select> <br/> <br/>";

                                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                                UserView += "    <br/> Pretražite po datumu <br/> ";

                                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                                UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                                UserView += "     <br/>Pretražite po oceni <br/> ";
                                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "        <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "         <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                                UserView += "   <p> <br/>Pretraga po ceni </p>";
                                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                                UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                                UserView += "    <input type=\"submit\" value=\"Sortiraj po udaljenosti\" id=\"sortirajPoUdaljenosti\"/>";  // sortira tabelu po

                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                sessionStorage.setItem("trenutniMeni", UserMenu);

                                $("#PageContent").html(UserView);
                                $("#PageMenu").html(UserMenu);
                                //
                            }
                            else if (data.Uloga == 2) {
                                // ADMIN
                                var voznjeTrenutne = trenutnoUlogovan.Voznje;
                                sessionStorage.setItem("trenutneVoznje", JSON.stringify(voznjeTrenutne));

                                UserView = " <br/> ";
                                UserView += "<input type=\"submit\" value=\"Prikazi sve voznje\" id=\"prikazSvihVoznji\"/>";
                                UserView += "<input type=\"submit\" value=\"Prikazi samo moje vožnje\" id=\"prikazAdminovihVoznji\"/>";
                                UserView += "    <table border=\"1\">";
                                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"2\"> </th>  </tr>";

                                for (v in data.Voznje) {
                                    // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                                    UserView += "<tr> <td> " + data.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + data.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";

                                    if (data.Voznje[v].Odrediste != null) {
                                        if (data.Voznje[v].Odrediste.Adresa.UlicaBroj != null) {
                                            UserView += " <td> " + data.Voznje[v].Odrediste.Adresa.UlicaBroj + " ";
                                        }
                                        else { UserView += "<td> "; }
                                    if (data.Voznje[v].Odrediste.Adresa.MestoPostanski != null) {
                                        UserView += data.Voznje[v].Odrediste.Adresa.MestoPostanski + " </td>";
                                    } else {
                                        UserView += " </td>";
                                    }
                                } else { UserView += " <td></td>"; }

                                    if (data.Voznje[v].Musterija != null) {
                                        UserView += "<td>" + data.Voznje[v].Musterija + "  </td>";
                                    } else {
                                        UserView += "<td></td>";
                                    }

                                    if (data.Voznje[v].Vozac == null || data.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                                    else { UserView += "<td>" + data.Voznje[v].Vozac + " </td> " }

                                    if (data.Voznje[v].Dispatcher == null || data.Voznje[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                                    else { UserView += "<td>" + data.Voznje[v].Dispatcher + " </td> " }

                                    var dodeli = "<td> </td>";
                                    var pomstat = "";

                                    //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                                    if (data.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + data.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                                    if (data.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + data.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                                    if (data.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                                    if (data.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                                    if (data.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                                    if (data.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                                    if (data.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                                    if (data.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                                    //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                                    UserView += "<td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + data.Voznje[v].Id + " /> </td>" + dodeli + "</tr > ";

                                }
                                UserView += "    </table>";
                                UserView += " <p> Pretraga po statusu </p>";
                                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                                UserView += "   <option value=\"0\">KREIRANA</option>";
                                UserView += "    <option value=\"1\">FORMIRANA</option>";
                                UserView += "    <option value=\"2\">OBRADJENA</option>";
                                UserView += "    <option value=\"3\">PRIHVACENA</option>";
                                UserView += "    <option value=\"4\">OTKAZANA</option>";
                                UserView += "    <option value=\"5\">NEUSPESNA</option>";
                                UserView += "    <option value=\"6\">USPESNA</option>";
                                UserView += "    <option value=\"7\">U_TOKU</option>";
                                UserView += "</select> <br/> <br/>";

                                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                                UserView += "    <br/> Unesite kriterijume pretrage <br/><br/> ";

                                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                                //UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

//                                UserView += "     <br/>Pretražite po oceni <br/> ";
                                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "        <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "         <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                //UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                                //UserView += "   <p> <br/>Pretraga po ceni </p>";
                                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                                //UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                                //UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu korisnika </p>";
                                UserView += " <br/>Ime korisnika: <br/>";
                                UserView += "<input type=\"text\" id=\"imeZaPretragu\" />";

                                UserView += " <br/>Prezime korisnika: <br/>";
                                UserView += "<input type=\"text\" id=\"prezimeZaPretragu\" />";
                                //UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"pretrazikorisnike\" value=\"Pretraži korisnike\" />";

                               // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu vozača </p>";
                                UserView += " <br/>Ime vozača: <br/>";
                                UserView += "<input type=\"text\" id=\"vimeZaPretragu\" />";

                                UserView += " <br/>Prezime vozača: <br/>";
                                UserView += "<input type=\"text\" id=\"vprezimeZaPretragu\" />";
                                UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"izvrsipretragu\" value=\"Pretraži\" />";

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcijeAdmina\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profilAdmina\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"novaVoznja\"> Nova vožnja </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"noviVozac\"> Novi vozač </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"blok\"> Blokiraj Korisnika </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";

                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                sessionStorage.setItem("trenutniMeni", UserMenu);

                                $("#PageContent").html(UserView);
                                $("#PageMenu").html(UserMenu);
                            }
                        }
                    });

                } else {
                    $("#Greske").html("Pogrešan unos lozinke ili korisničkog imena");
                }

            });

            $(document).on("click", "#opcijeVozaca", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserMenu = "";
                var UserView = "";

                var trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));

                UserMenu = "<table align=\"center\">";
                UserMenu += "  <tr> ";
                UserMenu += "        <td id=\"opcijeVozaca\"> Opcije </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"profilVozaca\"> Pregled profila </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"promenaLokacije\"> Promena Lokacije </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                UserMenu += "    </tr>";
                UserMenu += "</table>";
                //
                UserView = "<h2> Vožnje </h2> ";
                UserView += "    <table border=\"1\">";
                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th> </th> <th> </th> </tr>";

                // if (data.Voznje != null) {
                for (v in trenutnoUlogovan.Voznje) {
                   // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v] + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija.Name + " " + trenutnoUlogovan.Voznje[v].Musterija.LastName + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Name + " " + trenutnoUlogovan.Voznje[v].Vozac.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher.Name + " " + trenutnoUlogovan.Voznje[v].Dispatcher.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                    UserView += "<tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";
                    //if (trenutnoUlogovan.Voznje[v].Odrediste == null) { UserView += "<td>" + "" + "</td>"; }
                    //else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> " }

                    if (trenutnoUlogovan.Voznje[v].Odrediste != null) {
                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj != null) {
                            UserView += " <td> " + trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj + " ";
                        }
                        else { UserView += "<td> "; }
                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski != null) {
                            UserView += trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski + " </td>";
                        } else {
                            UserView += " </td>";
                        }
                    } else { UserView += "<td></td >"; }

                    if (trenutnoUlogovan.Voznje[v].Musterija != null) {
                        UserView += "<td>" + trenutnoUlogovan.Voznje[v].Musterija + "  </td >";
                    } else {
                        UserView += "<td></td >";
                    }

                    if (trenutnoUlogovan.Voznje[v].Vozac == null || trenutnoUlogovan.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                    else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Vozac + " </td> " }

                    if (trenutnoUlogovan.Voznje[v].Dispatcher == null || trenutnoUlogovan.Voznje[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                    else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Dispatcher + " </td> " }

                    var dodeli = "<td> </td>";
                    var pomstat = "";

                    //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                    //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                   // UserView += " <td> <input type=\"submit\" name=\"vozacMenjaVoznju\" value=\"Pregledaj\" id=" + trenutnoUlogovan.Voznje[v].Id + " /> </td>" + dodeli + "</tr > ";

                    UserView += "<td> <input type=\"submit\" value=\"Izmeni\" name=\"vozacMenjaVoznju\"  id=" + trenutnoUlogovan.Voznje[v].Id + "_" + pomstat + " /> </td> <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + trenutnoUlogovan.Voznje[v].Id + " /> </td>" + "</tr > ";

                }

                UserView += "    </table>";
                UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>";
                UserView += " <p> Pretraga po statusu </p>";
                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                UserView += "   <option value=\"0\">KREIRANA</option>";
                UserView += "    <option value=\"1\">FORMIRANA</option>";
                UserView += "    <option value=\"2\">OBRADJENA</option>";
                UserView += "    <option value=\"3\">PRIHVACENA</option>";
                UserView += "    <option value=\"4\">OTKAZANA</option>";
                UserView += "    <option value=\"5\">NEUSPESNA</option>";
                UserView += "    <option value=\"6\">USPESNA</option>";
                UserView += "    <option value=\"7\">U_TOKU</option>";
                UserView += "</select> <br/> <br/>";

                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                UserView += "    <br/> Pretražite po datumu <br/> ";

                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                UserView += "     <br/>Pretražite po oceni <br/> ";
                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                UserView += "        <option value=\"0\">0</option>";
                UserView += "        <option value=\"1\">1</option>";
                UserView += "        <option value=\"2\">2</option>";
                UserView += "        <option value=\"3\">3</option>";
                UserView += "        <option value=\"4\">4</option>";
                UserView += "        <option value=\"5\">5</option>";
                UserView += "    </select> <br/>";

                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                UserView += "        <option value=\"0\">0</option>";
                UserView += "         <option value=\"1\">1</option>";
                UserView += "        <option value=\"2\">2</option>";
                UserView += "        <option value=\"3\">3</option>";
                UserView += "        <option value=\"4\">4</option>";
                UserView += "        <option value=\"5\">5</option>";
                UserView += "    </select> <br/>";

                UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                UserView += "   <p> <br/>Pretraga po ceni </p>";
                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                UserView += "    <input type=\"submit\" value=\"Sortiraj po udaljenosti\" id=\"sortirajPoUdaljenosti\"/>";  // sortira tabelu po

                sessionStorage.setItem("trenutniPrikaz", UserView);
                sessionStorage.setItem("trenutniMeni", UserMenu);

                $("#PageContent").html(UserView);
                $("#PageMenu").html(UserMenu);
            });

            $(document).on("click", "#registracija", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserView = "";

                UserView = "    <table>";
                UserView += "    <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" /></td> </tr > ";
                UserView += "        <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" /> </td> </tr>";
                UserView += "        <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" /></td> </tr>";
                UserView += "        <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" /> </td> </tr>";
                UserView += "        <tr> <td> Pol: </td> <td>";
                UserView += "            <select name=\"Pol\" id=\"pol\" size=\"1\">";
                UserView += "               <option value=\"1\">Žensko</option>";
                UserView += "               <option value=\"0\">Muško</option>";
                UserView += "            </select>";
                UserView += "       </td> </tr>";
                UserView += "        <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" /> </td> </tr>";
                UserView += "        <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" /> </td> </tr>";
                UserView += "        <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" /> </td> </tr>";
                UserView += "<tr><td colspan='2' align='center'> <input type=\"submit\" value='Potvrda Registracije' id=\"potvrdaRegistracije\"/></td></tr>";
                UserView += " </table >";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#potvrdaRegistracije", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                // postaje musterija
                var UserView = "";

                if ($("#korisnickoIme").val() != "" && $("#korisnickaLozinka").val() != ""
                    && $("#Ime").val() != "" && $("#Prezime").val() != "" && $("#korisnickiJMBG").val() != "" && $("#korisnickiTelefon").val() != "" && $("#korisnickiEmail").val() != "") {
                    var objekat = {
                        UserName: $("#korisnickoIme").val(), Password: $("#korisnickaLozinka").val(), Name: $("#Ime").val(), LastName: $("#Prezime").val(),
                        Gender: $("#pol").val(), JMBG: $("#korisnickiJMBG").val(), PhoneNumber: $("#korisnickiTelefon").val(), Email: $("#korisnickiEmail").val()
                    };

                    $.post("/api/ahome/registration", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        }
                        else {
                            UserView = " <table> ";
                            UserView += "   <tr>";
                            UserView += "       <td> Korisničko ime </td>";
                            UserView += "       <td> <input type=\"text\" id=\"Username\" /> </td>";
                            UserView += "    </tr>";
                            UserView += "    <tr>";
                            UserView += "        <td> Lozinka </td>";
                            UserView += "        <td> <input type=\"password\" id=\"Password\" /> </td>";
                            UserView += "    </tr>";
                            UserView += "    <tr>";
                            UserView += "        <td> <input type=\"button\" value=\"Uloguj se\" id=\"logovanjeButton\" /></td>";
                            UserView += "    </tr>";

                            UserView += "</table>";

                            sessionStorage.setItem("trenutniPrikaz", UserView);
                            $("#PageContent").html(UserView);
                        }

                    });

                } else {
                    $("#Greske").html("Sva polja moraju biti popunjena!");
                }
            });

            $(document).on("click", "#opcije", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                var UserMenu = "";
                var UserView = "";

                var trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));
                //trenutnoUlogovan = sessionStorage.getItem("ulogovaniKorisnik");

                if (trenutnoUlogovan.Uloga == 0) {
                    // KORISNIK
                    UserView = " <br/> ";
                    UserView += "    <table border=\"1\">";
                    UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"3\"> </th> </tr>";



                    for (v in trenutnoUlogovan.Voznje) {
                       // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v] + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija+ "  </td > <td> " + trenutnoUlogovan.Voznje[v].Name + " " + trenutnoUlogovan.Voznje[v].Vozac.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher.Name + " " + trenutnoUlogovan.Voznje[v].Dispatcher.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                        // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija + "  </td > <td> " + data.Voznje[v].Name + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                        UserView += "<tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";
                        if (trenutnoUlogovan.Voznje[v].Odrediste == null) { UserView += "<td>" + "" + "</td>"; }
                        else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> " }

                        UserView += "<td>" + trenutnoUlogovan.Voznje[v].Musterija + "  </td >";

                        if (trenutnoUlogovan.Voznje[v].Vozac == null || trenutnoUlogovan.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                        else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Vozac + " </td> " }

                        if (trenutnoUlogovan.Voznje[v].Dispatcher == null || trenutnoUlogovan.Voznje[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                        else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Dispatcher + " </td> " }

                        var ponistiDugme = "<td> </td>";
                        var pomstat = "";
                        //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat ="KREIRANA"; ponistiDugme = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"ponistiVoznjuKorisnik\" value=\"Ponisti\"/></td>"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA";}
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA";}
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA";}
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA";}
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU";}
                        

                        UserView += "<td> <input type=\"submit\" name=\"korisnikMenjaVoznju\" value=\"Izmeni\" id=" + trenutnoUlogovan.Voznje[v].Id + "_" + pomstat+ " /> </td> <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + trenutnoUlogovan.Voznje[v].Id+" /> </td>" + ponistiDugme + "</tr > ";

                    }
                    UserView += "    </table>";
                    //UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>"; ovo vidi vozaccc
                    UserView += " <p> Pretraga po statusu </p>";
                    UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                    UserView += "   <option value=\"0\">KREIRANA</option>";
                    UserView += "    <option value=\"1\">FORMIRANA</option>";
                    UserView += "    <option value=\"2\">OBRADJENA</option>";
                    UserView += "    <option value=\"3\">PRIHVACENA</option>";
                    UserView += "    <option value=\"4\">OTKAZANA</option>";
                    UserView += "    <option value=\"5\">NEUSPESNA</option>";
                    UserView += "    <option value=\"6\">USPESNA</option>";
                    UserView += "    <option value=\"7\">U_TOKU</option>";
                    UserView += "</select> <br/> <br/>";

                    UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                    UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                    UserView += "    <br/> Pretražite po datumu <br/> ";

                    UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                    UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                    UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                    UserView += "     <br/>Pretražite po oceni <br/> ";
                    UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                    UserView += "   <select name=\"OceneMin\" size=\"1\">";
                    UserView += "        <option value=\"0\">0</option>";
                    UserView += "        <option value=\"1\">1</option>";
                    UserView += "        <option value=\"2\">2</option>";
                    UserView += "        <option value=\"3\">3</option>";
                    UserView += "        <option value=\"4\">4</option>";
                    UserView += "        <option value=\"5\">5</option>";
                    UserView += "    </select> <br/>";

                    UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                    UserView += "    <select name=\"OceneMax\" size=\"1\">";
                    UserView += "        <option value=\"0\">0</option>";
                    UserView += "         <option value=\"1\">1</option>";
                    UserView += "        <option value=\"2\">2</option>";
                    UserView += "        <option value=\"3\">3</option>";
                    UserView += "        <option value=\"4\">4</option>";
                    UserView += "        <option value=\"5\">5</option>";
                    UserView += "    </select> <br/>";

                    UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                    UserView += "   <p> <br/>Pretraga po ceni </p>";
                    UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                    UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                    UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                    UserMenu = "<table align=\"center\">";
                    UserMenu += "  <tr> ";
                    UserMenu += "        <td id=\"opcije\"> Opcije </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"profil\"> Pregled profila </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"novaVoznjaKorisnik\"> Nova vožnja </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                    UserMenu += "    </tr>";
                    UserMenu += "</table>";

                    sessionStorage.setItem("trenutniPrikaz", UserView);
                    sessionStorage.setItem("trenutniMeni", UserMenu);

                    $("#PageContent").html(UserView);
                    $("#PageMenu").html(UserMenu);

                }
                else if (data.Uloga == 1) {
                    //  DRIVER
                    $("#Greske").empty();
                    $("#AllGood").empty();

                    var UserMenu = "";
                    var UserView = "";

                    UserMenu = "<table align=\"center\">";
                    UserMenu += "  <tr> ";
                    UserMenu += "        <td id=\"opcijeVozaca\"> Opcije </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"profilVozaca\"> Pregled profila </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"promenaLokacije\"> Promena Lokacije </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                    UserMenu += "    </tr>";
                    UserMenu += "</table>";
                    //
                    UserView = "<h2> Vožnje </h2> ";
                    UserView += "    <table border=\"1\">";
                    UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th> </th> <th> </th> </tr>";

                    // if (data.Voznje != null) {
                    for (v in trenutnoUlogovan.Voznje) {
                       // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v] + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija.Name + " " + trenutnoUlogovan.Voznje[v].Musterija.LastName + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Name + " " + trenutnoUlogovan.Voznje[v].Vozac.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher.Name + " " + trenutnoUlogovan.Voznje[v].Dispatcher.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                        // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v] + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija.Name + " " + trenutnoUlogovan.Voznje[v].Musterija.LastName + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Name + " " + trenutnoUlogovan.Voznje[v].Vozac.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher.Name + " " + trenutnoUlogovan.Voznje[v].Dispatcher.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                        UserView += "<tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";
                        //if (trenutnoUlogovan.Voznje[v].Odrediste == null) { UserView += "<td>" + "" + "</td>"; }
                        //else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> " }

                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj != null) {
                            UserView += " <td> " + trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj + " ";
                        }
                        else { UserView += "<td> "; }
                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski != null) {
                            UserView += trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski + " </td>";
                        } else {
                            UserView += " </td>";
                        }


                        if (trenutnoUlogovan.Voznje[v].Musterija != null) {
                            UserView += "<td>" + trenutnoUlogovan.Voznje[v].Musterija + "  </td >";
                        } else {
                            UserView += "<td></td >";
                        }

                        if (trenutnoUlogovan.Voznje[v].Vozac == null || trenutnoUlogovan.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                        else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Vozac + " </td> " }

                        if (trenutnoUlogovan.Voznje[v].Dispatcher == null || trenutnoUlogovan.Voznje[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                        else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Dispatcher + " </td> " }

                        var dodeli = "<td> </td>";
                        var pomstat = "";

                        //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                        if (trenutnoUlogovan.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                        //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                        // UserView += " <td> <input type=\"submit\" name=\"vozacMenjaVoznju\" value=\"Pregledaj\" id=" + trenutnoUlogovan.Voznje[v].Id + " /> </td>" + dodeli + "</tr > ";

                        UserView += "<td> <input type=\"submit\" value=\"Izmeni\" name=\"vozacMenjaVoznju\"  id=" + trenutnoUlogovan.Voznje[v].Id + "_" + pomstat + " /> </td> <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + trenutnoUlogovan.Voznje[v].Id + " /> </td>" + "</tr > ";


                    }

                    UserView += "    </table>";
                    UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>";
                    UserView += " <p> Pretraga po statusu </p>";
                    UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                    UserView += "   <option value=\"0\">KREIRANA</option>";
                    UserView += "    <option value=\"1\">FORMIRANA</option>";
                    UserView += "    <option value=\"2\">OBRADJENA</option>";
                    UserView += "    <option value=\"3\">PRIHVACENA</option>";
                    UserView += "    <option value=\"4\">OTKAZANA</option>";
                    UserView += "    <option value=\"5\">NEUSPESNA</option>";
                    UserView += "    <option value=\"6\">USPESNA</option>";
                    UserView += "    <option value=\"7\">U_TOKU</option>";
                    UserView += "</select> <br/> <br/>";

                    UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                    UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                    UserView += "    <br/> Unesite parametre pretrage <br/> ";

                    UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                    UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                    UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                    //UserView += "     <br/>Pretražite po oceni <br/> ";
                    UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                    UserView += "   <select name=\"OceneMin\" size=\"1\">";
                    UserView += "        <option value=\"0\">0</option>";
                    UserView += "        <option value=\"1\">1</option>";
                    UserView += "        <option value=\"2\">2</option>";
                    UserView += "        <option value=\"3\">3</option>";
                    UserView += "        <option value=\"4\">4</option>";
                    UserView += "        <option value=\"5\">5</option>";
                    UserView += "    </select> <br/>";

                    UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                    UserView += "    <select name=\"OceneMax\" size=\"1\">";
                    UserView += "        <option value=\"0\">0</option>";
                    UserView += "         <option value=\"1\">1</option>";
                    UserView += "        <option value=\"2\">2</option>";
                    UserView += "        <option value=\"3\">3</option>";
                    UserView += "        <option value=\"4\">4</option>";
                    UserView += "        <option value=\"5\">5</option>";
                    UserView += "    </select> <br/>";

                    //UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                    //UserView += "   <p> <br/>Pretraga po ceni </p>";
                    UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                    UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                    //UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                    UserView += "    <input type=\"submit\" value=\"Sortiraj po udaljenosti\" id=\"sortirajPoUdaljenosti\"/>";  // sortira tabelu po

                    sessionStorage.setItem("trenutniPrikaz", UserView);
                    sessionStorage.setItem("trenutniMeni", UserMenu);

                    $("#PageContent").html(UserView);
                    $("#PageMenu").html(UserMenu);

                }
                else if (data.Uloga == 2) {
                    // ADMIN
                }
            });

            $(document).on("click", "#profil", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserView = "";

                UserView = " <table>";
                UserView += " <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" value=" + trenutnoUlogovan.UserName + " /></td> </tr>";
                UserView += "   <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" value=" + trenutnoUlogovan.Password + " /> </td> </tr>";
                UserView += "    <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" value=" + trenutnoUlogovan.Name + " /></td> </tr>";
                UserView += "   <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" value=" + trenutnoUlogovan.LastName + " /> </td> </tr>";
                if (trenutnoUlogovan.Gender == 1) {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "            <option value=\"0\">Muško</option>";
                    UserView += "        </select>";
                } else {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"0\">Muško</option>";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "        </select>";
                }
                /*UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                UserView += "            <option value=\"1\">Žensko</option>";
                UserView += "            <option value=\"2\">Muško</option>";
                UserView += "        </select>";*/
                UserView += "    </td> </tr>";
                UserView += "    <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" value=" + trenutnoUlogovan.JMBG + " /> </td> </tr>";
                UserView += "    <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" value=" + trenutnoUlogovan.PhoneNumber + " /> </td> </tr>";
                UserView += "    <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" value=" + trenutnoUlogovan.Email + " /> </td> </tr>";
                UserView += "   <tr><td colspan='2' align='center'> <input type=\"submit\" value=\"Promeni\" id=\"promeniProfil\" /></td></tr>";
                UserView += " </table >";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#promeniProfil", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                if ($("#korisnickoIme").val() != "" && $("#korisnickaLozinka").val() != ""
                    && $("#Ime").val() != "" && $("#Prezime").val() != "" && $("#korisnickiJMBG").val() != "" && $("#korisnickiTelefon").val() != "" && $("#korisnickiEmail").val() != "") {
                    var objekat = {
                        UserName: $("#korisnickoIme").val(), Password: $("#korisnickaLozinka").val(), Name: $("#Ime").val(), LastName: $("#Prezime").val(),
                        Gender: $("#pol").val(), JMBG: $("#korisnickiJMBG").val(), PhoneNumber: $("#korisnickiTelefon").val(), Email: $("#korisnickiEmail").val(), Id: trenutnoUlogovan.Id
                    };


                    $.get("/api/ahome/changeuser", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                            $("#AllGood").html("Izmene izvršene");
                        }
                    });
                } else {

                    var Greska = "Izmena koju ste uneli nije moguca";
                    $("#Greske").html(Greska);
                }

            });

            $(document).on("click", "#logout", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserMenu = "";
                var UserView = "";

                $.ajax({
                    url: "/api/ahome/logoutuser",
                    data: trenutnoUlogovan,
                    type: "DELETE"
                });
                trenutnoUlogovan = null;

                UserView = "<table>";
                UserView += "    <tr>";
                UserView += "        <td> Korisničko ime </td>";
                UserView += "        <td> <input type=\"text\" id=\"Username\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> Lozinka </td>";
                UserView += "        <td> <input type=\"password\" id=\"Password\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> <input type=\"button\" value=\"Uloguj se\" id=\"logovanjeButton\" /></td>";
                UserView += "    </tr>";
                UserView += "</table>";

                UserMenu = "<table align=\"center\"> ";
                UserMenu += "    <tr>";
                UserMenu += "        <td id=\"logovanje\"> Uloguj se </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"registracija\"> Registruj se </td>";
                UserMenu += "    </tr>";
                UserMenu += " </table>";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                sessionStorage.setItem("trenutniMeni", UserMenu);

                $("#PageContent").html(UserView);
                $("#PageMenu").html(UserMenu);
            });

            $(document).on("click", "#profilVozaca", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserView = "";

                UserView = " <table>";
                UserView += " <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" value=" + trenutnoUlogovan.UserName + " /></td> </tr>";
                UserView += "   <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" value=" + trenutnoUlogovan.Password + " /> </td> </tr>";
                UserView += "    <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" value=" + trenutnoUlogovan.Name + " /></td> </tr>";
                UserView += "   <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" value=" + trenutnoUlogovan.LastName + " /> </td> </tr>";
                if (trenutnoUlogovan.Gender == 1) {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "            <option value=\"0\">Muško</option>";
                    UserView += "        </select>";
                } else {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"0\">Muško</option>";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "        </select>";
                }
                UserView += "    </td> </tr>";
                UserView += "    <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" value=" + trenutnoUlogovan.JMBG + " /> </td> </tr>";
                UserView += "    <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" value=" + trenutnoUlogovan.PhoneNumber + " /> </td> </tr>";
                UserView += "    <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" value=" + trenutnoUlogovan.Email + " /> </td> </tr>";
                //
                UserView += "<tr> </td> <td> </td> <td></tr>";
                UserView += "<tr>";
                UserView += "    <td> Lokacija </td> <td> </td>";
                UserView += "</tr>";
                UserView += "     <tr> <td> Adresa: </td>  <td id=\"kord\"> " + trenutnoUlogovan.Lokacija.Adresa.UlicaBroj + "," + trenutnoUlogovan.Lokacija.Adresa.MestoPostanski + " </td> </tr>";

                UserView += " </table>";

                UserView +=   map;

                UserView += " <table>";
                UserView += "    <tr> <td> Registracija </td> <td> <input type=\"text\" id=\"korisnickaRegistracija\" value=" + trenutnoUlogovan.Automobil.Registracija + " /> </td> </tr>";
                UserView += "    <tr> <td> Godište </td> <td> <input type=\"text\" id=\"korisnickoGodiste\" value=" + trenutnoUlogovan.Automobil.GodisteAutomobila + " /> </td> </tr>";
                UserView += "   <tr> <td> Tip vozila </td> <td>";
                if (trenutnoUlogovan.Automobil.TipAutomobila == 0) {
                    UserView += "            <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                    UserView += "                <option value=\"0\">putnicki</option>";
                    UserView += "<option value=\"1\">kombi</option>";
                } else {
                    UserView += "                    <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                    UserView += "                        <option value=\"1\">kombi</option>";
                    UserView += "<option value=\"0\">putnicki</option>";
                }
                UserView += "</select>";
                UserView += "</td> </tr>";
                UserView += "   <tr><td colspan='2' align='center'> <input type=\"submit\" value=\"Promeni\" id=\"promeniVozaca\" /></td></tr>";
                UserView += " </table >";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#promeniVozaca", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                if ($("#korisnickoIme").val() != "" && $("#korisnickaLozinka").val() != ""
                    && $("#Ime").val() != "" && $("#Prezime").val() != "" && $("#korisnickiJMBG").val() != "" && $("#korisnickiTelefon").val() != "" && $("#korisnickiEmail").val() != ""
                    && $("#korisnickoGodiste").val() != "" && $("#korisnickaRegistracija").val() != "" && $("#TipVozila").val() != ""
                ) {
                    if (xx == null) {
                        xx = trenutnoUlogovan.Lokacija.Xcoordinate;
                        yy = trenutnoUlogovan.Lokacija.Ycoordinate;
                        ulica_broj = trenutnoUlogovan.Lokacija.Adresa.UlicaBroj;
                        grad = trenutnoUlogovan.Lokacija.Adresa.grad;
                    }

                    var objekat = {
                        UserName: $("#korisnickoIme").val(),
                        Password: $("#korisnickaLozinka").val(),
                        Name: $("#Ime").val(),
                        LastName: $("#Prezime").val(),
                        Gender: $("#pol").val(),
                        JMBG: $("#korisnickiJMBG").val(),
                        PhoneNumber: $("#korisnickiTelefon").val(),
                        Email: $("#korisnickiEmail").val(),
                        Id: trenutnoUlogovan.Id,
                        Lokacija:
                        {
                                Xcoordinate: xx,
                                Ycoordinate: yy,
                                Adresa: {
                                    UlicaBroj: ulica_broj,
                                    MestoPostanski: grad
                                }
                        },
                        Automobil:
                        {
                                GodisteAutomobila: $("#korisnickoGodiste").val(), 
                                Registracija: $("#korisnickaRegistracija").val(),
                                TipAutomobila: $("#TipVozila").val()
                        }
                    };

                    $.get("/api/ahome/changedriver", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                            $("#AllGood").html("Izmene izvršene");
                        }
                    });
                } else {

                    var Greska = "Izmena koju ste uneli nije moguca";
                    $("#Greske").html(Greska);
                }

            });

            $(document).on("click", "#opcijeAdmina", function () {
                //
                $("#Greske").empty();
                $("#AllGood").empty();

                var trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));

                var UserMenu = "";
                var UserView = "";

                var voznjeTrenutne = trenutnoUlogovan.Voznje;
                sessionStorage.setItem("trenutneVoznje", JSON.stringify(voznjeTrenutne)); 

                UserView = " <br/> ";
                UserView += "<input type=\"submit\" value=\"Prikazi sve vožnje\" id=\"prikazSvihVoznji\"/>";
                UserView += "<input type=\"submit\" value=\"Prikazi samo moje vožnje\" id=\"prikazAdminovihVoznji\"/>";
                UserView += "    <table border=\"1\">";
                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"2\"> </th>  </tr>";

                for (v in trenutnoUlogovan.Voznje) {
                   // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija + " " + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Vozac + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                    // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                    UserView += "<tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";

                    if (trenutnoUlogovan.Voznje[v].Odrediste != null) {

                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj != null) {
                            UserView += " <td> " + trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj + " ";
                        }
                        else { UserView += "<td> "; }
                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski != null) {
                            UserView += trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski + " </td>";
                        } else {
                            UserView += " </td>";
                        }
                    } else { UserView += "<td></td> " }


                    if (trenutnoUlogovan.Voznje[v].Musterija != null) {
                        UserView += "<td>" + trenutnoUlogovan.Voznje[v].Musterija + "  </td >";
                    } else {
                        UserView += "<td> </td>";
                    }

                    if (trenutnoUlogovan.Voznje[v].Vozac == null || trenutnoUlogovan.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                    else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Vozac + " </td> " }

                    if (trenutnoUlogovan.Voznje[v].Dispatcher == null || trenutnoUlogovan.Voznje[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                    else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Dispatcher + " </td> " }

                    var dodeli = "<td> </td>";
                    var pomstat = "";

                    //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                    //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                    UserView += " <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + trenutnoUlogovan.Voznje[v].Id + " /> </td>" + dodeli + "</tr > ";
                }
                UserView += "    </table>";
                UserView += " <p> Pretraga po statusu </p>";
                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                UserView += "   <option value=\"0\">KREIRANA</option>";
                UserView += "    <option value=\"1\">FORMIRANA</option>";
                UserView += "    <option value=\"2\">OBRADJENA</option>";
                UserView += "    <option value=\"3\">PRIHVACENA</option>";
                UserView += "    <option value=\"4\">OTKAZANA</option>";
                UserView += "    <option value=\"5\">NEUSPESNA</option>";
                UserView += "    <option value=\"6\">USPESNA</option>";
                UserView += "    <option value=\"7\">U_TOKU</option>";
                UserView += "</select> <br/> <br/>";

                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                UserView += "    <br/> Unesite parametre pretrage <br/> <br/> ";

                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime - local\" /> <br />";
                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime - local\" /> <br />";
                //UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

               // UserView += "     <br/>Pretražite po oceni <br/> ";
                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                UserView += "        <option value=\"0\">0</option>";
                UserView += "        <option value=\"1\">1</option>";
                UserView += "        <option value=\"2\">2</option>";
                UserView += "        <option value=\"3\">3</option>";
                UserView += "        <option value=\"4\">4</option>";
                UserView += "        <option value=\"5\">5</option>";
                UserView += "    </select> <br/>";

                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                UserView += "        <option value=\"0\">0</option>";
                UserView += "         <option value=\"1\">1</option>";
                UserView += "        <option value=\"2\">2</option>";
                UserView += "        <option value=\"3\">3</option>";
                UserView += "        <option value=\"4\">4</option>";
                UserView += "        <option value=\"5\">5</option>";
                UserView += "    </select> <br/>";

                //UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

               // UserView += "   <p> <br/>Pretraga po ceni </p>";
                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                //UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

               // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu korisnika </p>";
                UserView += " <br/>Ime korisnika: <br/>";
                UserView += "<input type=\"text\" id=\"imeZaPretragu\" />";

                UserView += " <br/>Prezime korisnika: <br/>";
                UserView += "<input type=\"text\" id=\"prezimeZaPretragu\" />";
                //UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"pretrazikorisnike\" value=\"Pretraži korisnike\" />";

               // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu vozača </p>";
                UserView += " <br/>Ime vozača: <br/>";
                UserView += "<input type=\"text\" id=\"vimeZaPretragu\" />";

                UserView += " <br/>Prezime vozača: <br/>";
                UserView += "<input type=\"text\" id=\"vprezimeZaPretragu\" />";
                UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"izvrsiPretragu\" value=\"Pretraži\" />";

                UserMenu = "<table align=\"center\">";
                UserMenu += "  <tr> ";
                UserMenu += "        <td id=\"opcijeAdmina\"> Opcije </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"profilAdmina\"> Pregled profila </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"novaVoznja\"> Nova vožnja </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"noviVozac\"> Novi vozač </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"blok\"> Blokiraj Korisnika </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                UserMenu += "    </tr>";
                UserMenu += "</table>";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                sessionStorage.setItem("trenutniMeni", UserMenu);

                $("#PageContent").html(UserView);
                $("#PageMenu").html(UserMenu);
                //
            });

            $(document).on("click", "#profilAdmina", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserView = "";

                UserView = " <table>";
                UserView += " <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" value=" + trenutnoUlogovan.UserName + " /></td> </tr>";
                UserView += "   <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" value=" + trenutnoUlogovan.Password + " /> </td> </tr>";
                UserView += "    <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" value=" + trenutnoUlogovan.Name + " /></td> </tr>";
                UserView += "   <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" value=" + trenutnoUlogovan.LastName + " /> </td> </tr>";
                UserView += "   <tr> <td> Pol: </td> <td>";
                if (trenutnoUlogovan.Gender == 1) {
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "            <option value=\"0\">Muško</option>";
                    UserView += "        </select>";
                } else {
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"0\">Muško</option>";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "        </select>";
                }
                UserView += "    </td> </tr>";
                UserView += "    <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" value=" + trenutnoUlogovan.JMBG + " /> </td> </tr>";
                UserView += "    <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" value=" + trenutnoUlogovan.PhoneNumber + " /> </td> </tr>";
                UserView += "    <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" value=" + trenutnoUlogovan.Email + " /> </td> </tr>";
                UserView += "   <tr><td colspan='2' align='center'> <input type=\"submit\" value=\"Promeni\" id=\"promeniAdmina\" /></td></tr>";
                UserView += " </table >";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);    
            });

            $(document).on("click", "#promeniAdmina", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                if ($("#korisnickoIme").val() != "" && $("#korisnickaLozinka").val() != ""
                    && $("#Ime").val() != "" && $("#Prezime").val() != "" && $("#korisnickiJMBG").val() != "" && $("#korisnickiTelefon").val() != "" && $("#korisnickiEmail").val() != "") {
                    var objekat = {
                        UserName: $("#korisnickoIme").val(), Password: $("#korisnickaLozinka").val(), Name: $("#Ime").val(), LastName: $("#Prezime").val(),
                        Gender: $("#pol").val(), JMBG: $("#korisnickiJMBG").val(), PhoneNumber: $("#korisnickiTelefon").val(), Email: $("#korisnickiEmail").val(), Id: trenutnoUlogovan.Id
                    };


                    $.get("/api/ahome/changeadmin", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                            $("#AllGood").html("Izmene izvršene");
                        }
                    });
                } else {

                    var Greska = "Izmena koju ste uneli nije moguca";
                    $("#Greske").html(Greska);
                }
            });

            $(document).on("click", "#blok", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                var UserView = "";

             // var BlokView = "";
                BlokView = "";
                //onda na serveru stavim novi u listu (ako je validan) korisnika koji su blokirani i ne nalazi vec u listi blokiranih - vratiti poruku da postoji vec u listi blokiranih
                //vratim novu listu
                //ispisem novu listu
                //saopstim da je korisnik uspesno blokiran u all good ako je uspesno blokiran
                //else stavim da nije uspesno blokiran

                //. . . . .pozovi funkciju za obracanje serveru. . . .

               // $("#Greske").html("Usao u funkciju");
                $.get("/api/ahome/blockedList", "") 
                    .done(function (data) {
                       //  $("#Greske").html("Dobavio blokirane");

                    var nesto = eval(data);
                    var table = "";
                    var table1 = "";
                    table += "";
                    table = " <h2> Blokirani korisnici </h2> ";
                    table += "    <table border=\"1\">";
                    table += "        <tr><th colspan=\"2\"> Blokirani korisnici </th> </tr>";

                    var select = "";
                    select += "<select name=\"Blokirani\" id=\"blocked\" size=\"1\">";
                        counter = 1;

                        for (v in nesto) {
                            table1 += "   <tr> <td>" + counter + "</td> <td> " + nesto[v] + " </td> </tr>";
                            select += " <option value =\"" + v + "\">" + nesto[v] + "</option>";
                            counter++;
                        }

                        select += "</select>";

                    if (table1 == "") {
                        table = "";
                        BlokView = "<br/> <br/><h2> Trenutno nema blokiranih korisnika </h2> <br/>";
                        
                    } else {
                        table1 += "</table> <br/>";
                        table += table1;
                        BlokView += table;
                        BlokView += select;
                        BlokView += "<input type=\"submit\" name=\"Odblokiraj\" value=\"Odblokiraj\" id=\"odblokiraj\" /> <br/>";
                    }

                    // UserView = "<h2> Trenutno nema blokiranih korisnika </h2> <br/>";
                    sessionStorage.setItem("PrviDeo", BlokView);

                        $.get("/api/ahome/unblockedList", "")
                            .done(function (data) {
                        //$("#Greske").html("Dobavio ne blokirane");

                        var nesto = eval(data);
                        var select = "";
                        //var BlokView1 = ""; S OVIM SIGURNO RADI!!!
                                BlokView1 = "";
                                BlokView1 += "<br/><select name=\"NeBlokirani\" id=\"nonblocked\" size=\"1\">";
                        for (v in nesto) {
                            select += " <option value =\"" + v + "\">" + nesto[v] + "</option>";
                        }
                        select += "</select> ";

                                BlokView1 += select;

                                BlokView1 += "<input type=\"submit\" id=\"blokirajk\" name=\"blokirajk\" value=\"Blokiraj\" />";

                                sessionStorage.setItem("DrugiDeo", BlokView);
                                UserView = BlokView + BlokView1;
                                //UserView += sessionStorage.getItem("PrviiDeo");
                                //UserView += sessionStorage.getItem("DrugiDeo");
                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                $("#PageContent").html(UserView);
                        });// 
                    });
               
                /*UserView = "";
                UserView = sessionStorage.getItem("PrviDeo");
                if (sessionStorage.getItem("DrugiDeo") == null) {

                    $.get("/api/ahome/unblockedList", "")
                        .done(function (data) {
                            //$("#Greske").html("Dobavio ne blokirane");

                            var nesto = eval(data);
                            var select = "";
                            BlokView = "";
                            BlokView += "<select name=\"NeBlokirani\" id=\"nonblocked\" size=\"1\">";
                            for (v in nesto) {
                                select += " <option value =\"" + v + "\">" + nesto[v] + "</option>";
                            }
                            select += "</select> <br/>";

                            BlokView += select;

                            BlokView += "<input type=\"submit\" id=\"blokiraj\" value=\"Blokiraj\" />";

                            sessionStorage.setItem("DrugiDeo", BlokView);
                        });//
                }*/

                /*UserView += sessionStorage.getItem("DrugiDeo");
                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
                 */
                

                //Trazi listu neblokiranih
               
                //

                
            });

            $(document).on("click", "#blokirajk", function () {
                var UserView = "";

                var korisnik = { nesto: $("#nonblocked").val() };
                if (korisnik != null && korisnik != "") {

                    $.get("/api/ahome/blokiranjga", korisnik, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            //Sve isto kao i kad dobavljamo inicijalno listu
                            $("#Greske").empty();
                            $("#AllGood").empty();

                            // var BlokView = "";
                            BlokView = "";

                            $.get("/api/ahome/blockedList", "")
                                .done(function (data) {

                                    var nesto = eval(data);
                                    var table = "";
                                    var table1 = "";
                                    table += "";
                                    table = " <h2> Blokirani korisnici </h2> ";
                                    table += "    <table border=\"1\">";
                                    table += "        <tr> <th colspan=\"2\"> Blokirani korisnici </th> </tr>";

                                    var select = "";
                                    select += "<select name=\"Blokirani\" id=\"blocked\" size=\"1\">";

                                    counter = 1;
                                    for (v in nesto) {
                                        table1 += "   <tr> <td>" + counter + "</td> <td> " + nesto[v] + " </td> </tr>";
                                        select += " <option value =\"" + v + "\">" + nesto[v] + "</option>";
                                        counter++;
                                    }

                                    select += "</select>";
                                    

                                    if (table1 == "") {
                                        table = "";
                                        BlokView = "<br/> <br/><h2> Trenutno nema blokiranih korisnika </h2> <br/>";

                                    } else {
                                        table1 += "</table> <br/>";
                                        table += table1;
                                        BlokView += table;
                                        BlokView += select;
                                        BlokView += "<input type=\"submit\" name=\"Odblokiraj\" value=\"Odblokiraj\" id=\"odblokiraj\" /> <br/>";
                                    }

                                    sessionStorage.setItem("PrviDeo", BlokView);

                                    $.get("/api/ahome/unblockedList", "")
                                        .done(function (data) {

                                            var nesto = eval(data);
                                            var select = "";
                                            BlokView1 = "";
                                            BlokView1 += "<br/><select name=\"NeBlokirani\" id=\"nonblocked\" size=\"1\">";
                                            for (v in nesto) {
                                                select += " <option value =\"" + v + "\">" + nesto[v] + "</option>";
                                            }
                                            select += "</select> ";

                                            BlokView1 += select;

                                            BlokView1 += "<input type=\"submit\" id=\"blokirajk\" name=\"blokirajk\" value=\"Blokiraj\" />";

                                            sessionStorage.setItem("DrugiDeo", BlokView);
                                            UserView = BlokView + BlokView1;
                                            sessionStorage.setItem("trenutniPrikaz", UserView);
                                            $("#PageContent").html(UserView);
                                        });// 
                                });

                            $("#AllGood").html("Korisnik je blokiran");
                            // ponovo se obrati serveru da dobavis sve blokirane i sve neblokirane jer su sada izmenjeni 
                        }

                    });

                }
            });

            $(document).on("click", "#odblokiraj", function () {
                var UserView = "";

                var korisnik = { nesto: $("#blocked").val() };
                if (korisnik != null && korisnik != "") {

                    $.get("/api/ahome/odblokirajga", korisnik, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            $("#Greske").empty();
                            $("#AllGood").empty();
                            $("#AllGood").html("Korisnik je odblokiran");

                            BlokView = "";

                            $.get("/api/ahome/blockedList", "")
                                .done(function (data) {

                                    var nesto = eval(data);
                                    var table = "";
                                    var table1 = "";
                                    table += "";
                                    table = " <h2> Blokirani korisnici </h2> ";
                                    table += "    <table border=\"1\">";
                                    table += "        <tr> <th colspan=\"2\"> Blokirani korisnici </th> </tr>";

                                    var select = "";
                                    select += "<select name=\"Blokirani\" id=\"blocked\" size=\"1\">";

                                    counter = 1;
                                    for (v in nesto) {
                                        table1 += "   <tr> <td>" + counter + "</td> <td> " + nesto[v] + " </td> </tr>";
                                        select += " <option value =\"" + v + "\">" + nesto[v] + "</option>";
                                        counter++;
                                    }

                                    select += "</select>";
                                    

                                    if (table1 == "") {
                                        table = "";
                                        BlokView = "<br/> <br/><h2> Trenutno nema blokiranih korisnika </h2> <br/>";

                                    } else {
                                        table1 += "</table> <br/>";
                                        table += table1;
                                        BlokView += table;
                                        BlokView += select;
                                        BlokView += "<input type=\"submit\" name=\"Odblokiraj\" value=\"Odblokiraj\" id=\"odblokiraj\" /> <br/>";
                                    }

                                    sessionStorage.setItem("PrviDeo", BlokView);

                                    $.get("/api/ahome/unblockedList", "")
                                        .done(function (data) {

                                            var nesto = eval(data);
                                            var select = "";
                                            BlokView1 = "";
                                            BlokView1 += "<br/><select name=\"NeBlokirani\" id=\"nonblocked\" size=\"1\">";
                                            for (v in nesto) {
                                                select += " <option value =\"" + v + "\">" + nesto[v] + "</option>";
                                            }
                                            select += "</select> ";

                                            BlokView1 += select;

                                            BlokView1 += "<input type=\"submit\" id=\"blokirajk\" name=\"blokirajk\" value=\"Blokiraj\" />";

                                            sessionStorage.setItem("DrugiDeo", BlokView);
                                            UserView = BlokView + BlokView1;
                                            sessionStorage.setItem("trenutniPrikaz", UserView);
                                            $("#PageContent").html(UserView);
                                        });// 
                                });

                        }
                    });
                }


            });

            $(document).on("click", "#noviVozac", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserMenu = "";
                var UserView = "";

                UserView = "<h2> Unesite informacije o vozaču </h2>"
                UserView += " <table>";
                UserView += " <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" value=\"\" /></td> </tr>";
                UserView += "   <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" value=\"\" /> </td> </tr>";
                UserView += "    <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" value=\" \" /></td> </tr>";
                UserView += "   <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" value=\" \" /> </td> </tr>";

                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"0\">Muško</option>";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "        </select>";

                UserView += "    </td> </tr>";
                UserView += "    <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" value=\" \" /> </td> </tr>";
                UserView += "    <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" value=\"\" /> </td> </tr>";
                UserView += "    <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" value=\"\" /> </td> </tr>";
                //
                UserView += "<tr> </td> <td> </td> <td></tr>";
                UserView += "<tr>";
                UserView += "    <td> Lokacija </td> <td> </td>";
                UserView += "</tr>";
                UserView += "     <tr> <td> Adresa: </td>  <td id=\"kord\"> </td> </tr>";   // kako da se ispisu kordinate kad kliknem

                UserView += " </table>";

                UserView += map;

                UserView += " <table>";
                UserView += "    <tr> <td> Registracija </td> <td> <input type=\"text\" id=\"korisnickaRegistracija\" value=\"\" /> </td> </tr>";
                UserView += "    <tr> <td> Godište </td> <td> <input type=\"text\" id=\"korisnickoGodiste\" value=\"\" /> </td> </tr>";
                UserView += "   <tr> <td> Tip vozila </td> <td>";

                    UserView += "            <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                    UserView += "                <option value=\"0\">putnicki</option>";
                    UserView += "<option value=\"1\">kombi</option>";

                UserView += "</select>";
                UserView += "</td> </tr>";
                UserView += "   <tr><td colspan='2' align='center'> <input type=\"submit\" value=\"Kreiraj vozača\" id=\"kreirajVozaca\" /></td></tr>";
                UserView += " </table >";

                UserMenu = "<table align=\"center\">";
                UserMenu += "  <tr> ";
                UserMenu += "        <td id=\"opcijeAdmina\"> Opcije </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"profilAdmina\"> Pregled profila </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"novaVoznja\"> Nova vožnja </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"noviVozac\"> Novi vozač </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"blok\"> Blokiraj Korisnika </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                UserMenu += "    </tr>";
                UserMenu += "</table>";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                sessionStorage.setItem("trenutniMeni", UserMenu);
                $("#PageContent").html(UserView);
                $("#PageMenu").html(UserMenu);
            });

            $(document).on("click", "#kreirajVozaca", function () {
                $("#Greske").empty();
                $("#AllGood").empty();


                if ($("#korisnickoIme").val() != "" && $("#korisnickaLozinka").val() != ""
                    && $("#Ime").val() != "" && $("#Prezime").val() != "" && $("#korisnickiJMBG").val() != "" && $("#korisnickiTelefon").val() != "" && $("#korisnickiEmail").val() != ""
                    && $("#korisnickoGodiste").val() != "" && $("#korisnickaRegistracija").val() != "" && $("#TipVozila").val() != ""
                ) {
                    if (xx == null) {
                        /*xx = trenutnoUlogovan.Lokacija.Xcoordinate;
                        yy = trenutnoUlogovan.Lokacija.Ycoordinate;
                        ulica_broj = trenutnoUlogovan.Lokacija.Adresa.UlicaBroj;
                        grad = trenutnoUlogovan.Lokacija.Adresa.grad;*/
                        var Greska = "Niste ispravno popunili polja";
                        $("#Greske").html(Greska);
                        //break;

                    } else {
                        var objekat = {
                            UserName: $("#korisnickoIme").val(),
                            Password: $("#korisnickaLozinka").val(),
                            Name: $("#Ime").val(),
                            LastName: $("#Prezime").val(),
                            Gender: $("#pol").val(),
                            JMBG: $("#korisnickiJMBG").val(),
                            PhoneNumber: $("#korisnickiTelefon").val(),
                            Email: $("#korisnickiEmail").val(),
                            Id: trenutnoUlogovan.Id,
                            Lokacija:
                                {
                                    Xcoordinate: xx,
                                    Ycoordinate: yy,
                                    Adresa: {
                                        UlicaBroj: ulica_broj,
                                        MestoPostanski: grad
                                    }
                                },
                            Automobil:
                                {
                                    GodisteAutomobila: $("#korisnickoGodiste").val(),
                                    Registracija: $("#korisnickaRegistracija").val(),
                                    TipAutomobila: $("#TipVozila").val()
                                }
                        };

                        //
                        $.post("/api/ahome/kreiranjekorisnika", objekat, function (data, status) {
                            if (data.UserName == null) {
                                $("#Greske").html(data);
                            } else {
                                //trenutnoUlogovan = data;
                                //sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                                $("#AllGood").html("Vozač kreiran");
                            }
                            //

                        });
                    }

                    
                 }else {

                    var Greska = "Niste ispravno popunili polja";
                    $("#Greske").html(Greska);
                }

                //////////////////////////////////////////////////

            });

            $(document).on("click", "#novaVoznja", function(){
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserView = "";

                UserView = "<p> Izaberite početnu lokaciju </p>";
                UserView += map;

                UserView += "<table> <tr> <td> Adresa: </td> <td id=\"kord\"> </td> </tr> </table>";

                UserView += "    Tip vozila ";

                UserView += "            <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                UserView += "                <option value=\"0\">putnicki</option>";
                UserView += "<option value=\"1\">kombi</option> </select>";

                UserView += "<br/>Ovde sledi izbor vozaca <br/>";

                UserView += "<select name=\"vozaci\" id=\"vozaci\" size=\"1\">";
                //
                //UserView += pomocVozaci;
                UserView += sessionStorage.getItem("najblizivozaci");

                UserView += "</select>";

                UserView += "<input value=\"Kreiraj vožnju\" type=\"submit\"  id=\"kreirajvoznju\" />";
                // Sta ako izabrani vozac nema to vozilo
                //NAPRAVI FUNKCIJU KOJA CE DA PROVERI DA LI TRAZENI VOZAC IMA AUTO KOJI JE SELEKTOVAN AKO NEMA ONDA VRATI GRESKU

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#novaVoznjaKorisnik", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var UserView = "";

                UserView = "<h2> Izaberite početnu lokaciju </h2>";
                UserView += map;

                UserView += "<table> <tr> <td> Adresa: </td> <td id=\"kord\"> </td> </tr> </table>";

                UserView += "    Tip vozila ";

                UserView += "            <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                UserView += "                <option value=\"0\">putnicki</option>";
                UserView += "<option value=\"1\">kombi</option> </select>";
                //

                UserView += "<input value=\"Kreiraj vožnju\" type=\"submit\"  id=\"kreirajvoznjuKORISNIK\" />";
                // Sta ako izabrani vozac nema to vozilo
                //NAPRAVI FUNKCIJU KOJA CE DA PROVERI DA LI TRAZENI VOZAC IMA AUTO KOJI JE SELEKTOVAN AKO NEMA ONDA VRATI GRESKU

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#kreirajvoznjuKORISNIK", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));

                if ($("#kord").val() != null) {

                    if (xx == null) {
                        $("#Greske").html("Niste izabrali lokaciju voznje");
                    } else {
                        var objekat = {
                            LokacijaPolazna: {
                                Xcoordinate: xx,
                                Ycoordinate: yy,
                                Adresa: {
                                    UlicaBroj: ulica_broj,
                                    MestoPostanski: grad
                                }
                            },
                            TipVozila: $("#TipVozila").val(),
                            MusterijaId: (JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"))).Id
                        };

                        $.post("/api/ahome/korisnikKreiraVoznju", objekat, function (data, status) {
                            if (data == "") {
                                $("#Greske").html("Morate izabrati lokaciju da bi ste kreirali vožnju");
                            } else {
                                $("#AllGood").html("Vožnja uspešno kreirana");
                                trenutnoUlogovan = data;

                                sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(data));

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcije\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profil\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"novaVoznjaKorisnik\"> Nova vožnja </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";

                                sessionStorage.setItem("trenutniMeni", UserMenu);
                                $("#PageMenu").html(UserMenu);
                            }
                        });

                    }

                } ////////////////////////////////////////////////////////////////////////////////////////////////////
                else {
                    $("#Greske").html("Lokacija nije unesena. Lokaciju selektujte dvoklikom.");
                }
                
            });

            $(document).on("click", "#kreirajvoznju", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                //
                if ($("#kord").val() != null) {
                    if (kord == null) {
                        $("#Greske").html("Niste izabrali lokaciju voznje");
                    } else {
                        var objekat = {
                            LokacijaPolazna: {
                                Xcoordinate: xx,
                                Ycoordinate: yy,
                                Adresa: {
                                    UlicaBroj: ulica_broj,
                                    MestoPostanski: grad
                                }
                            },
                            Dispatcher: trenutnoUlogovan.Id,
                            Vozac: $("#vozaci").val(),
                            TipVozila: $("#TipVozila").val()
                        };

                        $.post("/api/ahome/kreiranjevoznje", objekat, function (data, status) {
                            if (data.Id == null) {
                                $("#Greske").html(data);
                            } else {
                                $("#AllGood").html("Vožnja uspešno kreirana");
                                //trenutnoUlogovan = data;
                                //sessionStorage.setItem();
                                sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(data));
                            }
                        });
                    }
                }////////////////////////////////////////////////////////////////////////////////////////////////////
                else { $("#Greske").html("Lokacija nije selektovana. Lokaciju unosite dvoklikom.");}

            });

            $(document).on("click", "#promenaLokacije", function () {

                $("#Greske").empty();
                $("#AllGood").empty();

                var UserView = "";

                UserView += "<h2> Izaberite lokaciju na mapi </h2>";
                UserView += map;
                UserView += "<br/> Vasa lokacija je: ";
                UserView += "   <table> <tr> <td id=\"kord\"> </td> </tr> </table>";
                UserView += "<input type=\"submit\" value=\"Promeni lokaciju\" id=\"promeniLok\"/>";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#promeniLok", function () {

                //var korisnik = sessionStorage.getItem("ulogovaniKorisnik");
                var korisnik = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));
                var pomocni = JSON.parse(sessionStorage.getItem("ulogovaniId"));

                korisnik = {
                    Lokacija:
                        {
                            Xcoordinate: xx,
                            Ycoordinate: yy,
                            Adresa: {
                                UlicaBroj: ulica_broj,
                                MestoPostanski: grad
                            }
                        },
                    Id : pomocni
                }

                if (xx == null)
                {
                    var Greska = "Niste ispravno popunili polja";
                    $("#Greske").html(Greska);
                }
                else
                {
                    $.post("/api/ahome/izmenaLokacije", korisnik, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                            $("#AllGood").html("Lokacija izmenjena");
                        }
                    });
                }

                
            });

            $(document).on("click", "[name='ponistiVoznjuKorisnik']", function () {
                //var Id = $(this).attr("id");
                var UserView = "";
                var id1 = $(this).attr("id");
                var Id = { nesto: $(this).attr("id") };
                $("#Greske").empty();
                $("#AllGood").empty();

                if (Id != null) {
                    $.get("/api/ahome/korisnikponistavavoznju", Id, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                            //$("#AllGood").html("Lokacija izmenjena");
                            $("#AllGood").html("Uspešno ste poništili vožnju");
                            //
                            UserView += "<h2> Unesite komentar </h2>";
                            UserView += "<input type=\"text\" name=\"korisnikKomentar\" id=\"korisnikKomentar\"/> <br/>";
                            UserView += "Ocenite voznju: ";
                            UserView += "   <select id=\"Ocena\" name=\"Ocena\" size=\"1\">";
                            UserView += "        <option value=\"0\">0</option>";
                            UserView += "        <option value=\"1\">1</option>";
                            UserView += "        <option value=\"2\">2</option>";
                            UserView += "        <option value=\"3\">3</option>";
                            UserView += "        <option value=\"4\">4</option>";
                            UserView += "        <option value=\"5\">5</option>";
                            UserView += "    </select> <br/>";
                            UserView += "<input type=\"submit\" name=\"korisnikStaviKomentar\" value=\"Postavi komentar\" id=" + id1 +"/>";

                            sessionStorage.setItem("trenutniPrikaz", UserView);

                            $("#PageContent").html(UserView);

                        }
                    });
                } else {
                    $("#Greske").html("FAILS");
                } 

            });

            $(document).on("click", "[name='korisnikStaviKomentar']", function () {
                var UserView = "";
                $("#Greske").empty();
                $("#AllGood").empty();
                var Id = { idVoznje: $(this).attr("id"), komentar: $("#korisnikKomentar").val(), ocena: $("#Ocena").val() };
                if (Id != null) {
                    $.get("/api/ahome/korisnikpostavljakomentarnaponistenu", Id, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            $("#Greske").empty();
                            $("#AllGood").empty();
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                            $("#AllGood").html("Komentar je poslat");

                            /*UserView += "<h2> Unesite komentar </h2>";
                            UserView += "<input type=\"text\" name=\"korisnikKomentar\" id=\"korisnikKomentar\"/><br/>";
                            UserView += "<input type=\"submit\" value=\"Postavi komentar\" name=\"korisnikStaviKomentar\" id=" + Id.nesto + "/>";
                            */
                            sessionStorage.setItem("trenutniPrikaz", UserView);

                            $("#PageContent").html(UserView);

                        }
                    });
                } else {
                    $("#Greske").html("FAILS");
                } 
            });

            $(document).on("click", "[name='Pregledajvoznju']", function () {
                var UserView = "";
                $("#Greske").empty();
                $("#AllGood").empty();

                var i = $(this).attr("id");
                var Id = { idVoznje: $(this).attr("id") };
                if (Id != null) {
                    $.get("/api/ahome/korisnikgledavoznju", Id, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            //var trenutnoUlogovan = data;
                            //sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));

                            UserView += "<h2> Podaci o vožnji </h2>";

                            UserView += "<table>";
                            for (v in data.Voznje) {
                                if (data.Voznje[v].Id == i || ((data.Voznje[v].Id + "/") == i)) {

                                    if (data.Voznje[v].LokacijaPolazna != null) {
                                        if (data.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj != null) {
                                            UserView += "<tr> <td> Adresa polaska:    </td> <td>" + data.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " ";
                                        } else {
                                            UserView += "<tr> <td> Adresa polaska:    </td> <td>";
                                       }

                                        if (data.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski != null) {
                                            UserView += data.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + "</td > </tr >";
                                        } else {
                                            UserView += "</td > </tr >";
                                        }
                                    } else {
                                        UserView += "<tr> <td> Adresa polaska:    </td> <td>";
                                    }

                                    //UserView += "<tr> <td> Adresa polaska:    </td> <td>" + trenutnoUlogovan.Voznje[v].LokacijaPolazna.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.MestoPostanski + "</td> </tr>";

                                    if (data.Voznje[v].Odrediste != null) {
                                        if (data.Voznje[v].Odrediste.Adresa.UlicaBroj != null) {
                                            UserView += "<tr> <td> Adresa odredišta:</td> <td>" + data.Voznje[v].Odrediste.Adresa.UlicaBroj + " ";
                                        }
                                        else {
                                            UserView += "<tr> <td> Adresa odredišta:</td> <td>";
                                        }
                                    } else {
                                        UserView += "<tr> <td> Adresa odredišta:</td> <td>";
                                    }

                                    //UserView += "<tr> <td> Adresa odredišta:</td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].Odrediste.MestoPostanski + "</td></tr>";

                                    if (data.Voznje[v].DatumIVremePorudzbine != null) {
                                        UserView += "<tr> <td> Datum i vreme porudžbine: </td> <td>" + data.Voznje[v].DATUMM + "</td></tr>";
                                    } else {
                                        UserView += "<tr> <td> Datum i vreme porudžbine: </td> <td></td></tr>";
                                    }

                                    //UserView += "<tr> <td> Datum i vreme porudžbine: </td> <td>" + trenutnoUlogovan.Voznje[v].DatumIVremePorudzbine + "</td></tr>";
                                    UserView += "<tr> <td> Poručilac: </td> <td>" + data.Voznje[v].Musterija + "</td></tr>";

                                    if (data.Voznje[v].Dispatcher != null) {
                                        UserView += "<tr> <td> Dispečer: </td> <td> " + data.Voznje[v].Dispatcher + " </td></tr>";
                                    } else {
                                        UserView += "<tr> <td> Dispečer: </td> </tr>";
                                    }

                                    if (data.Voznje[v].Vozac != null) {
                                        UserView += "<tr> <td> Vozač: </td> <td> " + data.Voznje[v].Vozac + " </td></tr>";
                                    } else {
                                        UserView += "<tr> <td> Vozač: </td> </tr>";
                                    }

                                    if (data.Voznje[v].Iznos != null) {
                                        UserView += "<tr> <td> Cena: </td> <td> " + data.Voznje[v].Iznos + " </td></tr>";
                                    } else {
                                        UserView += "<tr> <td> Cena: </td> </tr>";
                                    }

                                    //UserView += "<tr> <td> Vozač: </td> <td>" + trenutnoUlogovan.Voznje[v].Vozac + "</td></tr>";
                                    //UserView += "<tr> <td> Cena:</td><td>" + trenutnoUlogovan.Voznje[v].Iznos + "</td> </tr>";

                                    UserView += "<tr> <td> Status:</td>";

                                    //
                                    if (data.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; }
                                    if (data.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; }
                                    if (data.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; }
                                    if (data.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; }
                                    if (data.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; }
                                    if (data.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; }
                                    if (data.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; }
                                    if (data.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; }
                                    //

                                    UserView += "</tr>";

                                    UserView += "<tr> <td> Tip vozila:</td>";

                                    if (data.Voznje[v].TipVozila == 0) {
                                        UserView += "<td>Putnički</td>";
                                    } else {
                                        UserView += "<td>Kombi</td>";
                                    }
                                    UserView += "</tr>";
                                   // UserView += "<tr> <td> Tip vozila:</td><td>" + trenutnoUlogovan.Voznje[v].TipVozila + "</td> </tr>";

                                    if (data.Voznje[v].Komentar!=null) {
                                        UserView += "<tr> <td> Komentar:</td><td>" + data.Voznje[v].Komentar.Opis + "</td> </tr>";
                                        UserView += "<tr> <td> Datum objave:</td><td>" + data.Voznje[v].Komentar.Objavljeno + "</td> </tr>";
                                        UserView += "<tr> <td> Ocena:</td><td>" + data.Voznje[v].Komentar.Ocena + "</td> </tr>";
                                        UserView += "<tr> <td> Postavio:</td><td>" + data.Voznje[v].Komentar.KorisnikKojiJeOstavioKomentar + "</td> </tr>";
                                    }
                                } 
                            }
                            UserView += "</table>";

                           // UserView += "<table> <tr> <td> Polazna lokacija </td> <td> </tr> </table>";
                            sessionStorage.setItem("trenutniPrikaz", UserView);
                            $("#PageContent").html(UserView);
                            
                        }
                    });
                }
                else { $("#Greske").html("FAILS");}
            });

            $(document).on("click", "[name='adminDodeliVoznji']", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));

                var UserMenu = "";
                var UserView = "";

                UserView += "<h2> Izaberite vozaca za izabranu voznju</h2>";
                var help = {
                    idVoznje: $(this).attr("id")
                };

                var h = $(this).attr("id");

                $.get("/api/ahome/najblizi2", help, function (data, status) {
                    var nesto = eval(data);
                    var pom = "";
                    for (var k in nesto) {
                        pom += "<option value=\"" + k + "\">" + nesto[k] + "</option>";
                    }
                    var pomocVozaci = pom;
                    sessionStorage.setItem("najblizivozaci", pomocVozaci);
                    $("#vozaciAdmin").html(pom);
                    UserView += "<select name=\"vozaci\" id=\"vozaci\" size=\"1\">";
                    //
                    UserView += pomocVozaci;
                    //UserView += sessionStorage.getItem("najblizivozaci");

                    UserView += "</select>"; // popuni select za najblize vozace 

                    UserView += "<input type=\"submit\" value=\"Izaberi\" name=\"adminDodeljujeVozaca\" id ="+ h+ "/>"

                    sessionStorage.setItem("trenutniPrikaz", UserView);
                    $("#PageContent").html(UserView);
                }); // VRACA 5 NAJBLIZIH 

            });

            $(document).on("click", "[name='adminDodeljujeVozaca']", function () {
                var UserView = "";
                $("#Greske").empty();
                $("#AllGood").empty();
                trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));
                var UserView = "";

                var help = { idVoznje: $(this).attr("id"), vozac: $("#vozaci").val(), dispId: trenutnoUlogovan.Id};

                $.get("/api/ahome/adminOpDodeli", help, function (data, status) {
                    if (data != null) {
                        $("#AllGood").html("Uspesno dodeljen vozac");
                        sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(data));
                    } else {
                        $("#Greske").html(data);
                        //sessionStorage.setItem("trentutnoUlogovan", data);
                        //sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                    }

                });


                //$("#AllGood").html("Usli u funkciju dodele vozaca");
                sessionStorage.setItem("trenutniPrikaz", UserView);
            });

            $(document).on("click", "[name='korisnikMenjaVoznju']", function () {
                var UserView = "";
                $("#Greske").empty();
                $("#AllGood").empty();

                var i = $(this).attr("id");
                var Id = { idVoznje: $(this).attr("id") }; 
                var stat = ""; // CUPAM status 
                var delovi = i.split("_");

                var idVoznje1 = delovi[0];
                stat = delovi[1];
                if (Id != null) {
                    var objekatSlanje = { idVoznje: idVoznje1};
                    if (stat == "KREIRANA") {
                        // VIEW KOJI NUDI IZMENU POLAZNE LOKACIJE zeljene voznje
                        //
                        $("#Greske").empty();
                        $("#AllGood").empty();

                        var UserView = "";

                        UserView = "<h2> Izaberite početnu lokaciju </h2>";
                        UserView += map;

                        UserView += "<table> <tr> <td> Adresa: </td> <td id=\"kord\"> </td> </tr> </table>";

                        UserView += "    Tip vozila ";

                        UserView += "            <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                        UserView += "                <option value=\"0\">putnicki</option>";
                        UserView += "<option value=\"1\">kombi</option> </select>";
                        //

                        UserView += "<input value=\"Izmeni trenutnu vožnju\" type=\"submit\" name=\"korisnikSaljeIzmene\"  id="+idVoznje1+" />";
                        // Sta ako izabrani vozac nema to vozilo
                        //NAPRAVI FUNKCIJU KOJA CE DA PROVERI DA LI TRAZENI VOZAC IMA AUTO KOJI JE SELEKTOVAN AKO NEMA ONDA VRATI GRESKU

                        sessionStorage.setItem("trenutniPrikaz", UserView);
                        $("#PageContent").html(UserView);
                        //
                    }
                    else if (stat == "USPESNA")
                    {
                        //View koji nudi unos komentara zeljene voznje
                        $("#Greske").empty();
                        $("#AllGood").empty();

                        UserView += "<h2> Unesite komentar </h2>";
                        UserView += "<input type=\"text\" name=\"korisnikKomentar\" id=\"korisnikKomentar\"/> <br/>";
                        UserView += "Ocenite voznju: ";
                        UserView += "   <select id=\"Ocena\" name=\"Ocena\" size=\"1\">";
                        UserView += "        <option value=\"0\">0</option>";
                        UserView += "        <option value=\"1\">1</option>";
                        UserView += "        <option value=\"2\">2</option>";
                        UserView += "        <option value=\"3\">3</option>";
                        UserView += "        <option value=\"4\">4</option>";
                        UserView += "        <option value=\"5\">5</option>";
                        UserView += "    </select> <br/>";
                        UserView += "<input type=\"submit\" name=\"korisnikIzmeniKomentar\" value=\"Postavi komentar\" id=" + idVoznje1 + "/>";

                        sessionStorage.setItem("trenutniPrikaz", UserView);

                        $("#PageContent").html(UserView);

                    } else
                    {
                        $("#Greske").html("Vožnja se može izmeniti samo ako je u stanju Kreirana ili uspešna. <br/> Trenutno nije moguće izmeniti željenu vožnju.");
                        $("#Greske").focus();
                    }

                } else {
                      $("#Greske").html("FAILS CHANGES"); 
                }
            });

            $(document).on("click", "[name='korisnikSaljeIzmene']", function () {
                //korisnikmenjapocetnulok
                $("#Greske").empty();
                $("#AllGood").empty();


                if (kord == null) {
                    $("#Greske").html("Niste izabrali lokaciju voznje");
                } else {
                    var objekat = {
                        LokacijaPolazna: {
                            Xcoordinate: xx,
                            Ycoordinate: yy,
                            Adresa: {
                                UlicaBroj: ulica_broj,
                                MestoPostanski: grad
                            }
                        },
                        TipVozila: $("#TipVozila").val(),
                        MusterijaId: trenutnoUlogovan.Id,
                        Id: $(this).attr("id")
                    };

                    $.post("/api/ahome/korisnikmenjapocetnulok", objekat, function (data, status) {
                        if (data.Id == null) {
                            $("#Greske").html("Niste poslali ispravnu lokaciju");
                        } else {
                            $("#AllGood").html("Uspesno izmenjena lokacija");
                            trenutnoUlogovan = data;
                        }
                    });

                }
            });

            $(document).on("click", "[name='korisnikIzmeniKomentar']", function () {
                var Id = { idVoznje: $(this).attr("id"), komentar: $("#korisnikKomentar").val(), ocena: $("#Ocena").val() };

                if (Id != null && Id.komentar != "") {
                    if (Id != null) {
                        $.get("/api/ahome/korisnikmenjakomentar", Id, function (data, status) {
                            if (data.UserName == null) {
                                $("#Greske").html(data);
                            } else {
                                trenutnoUlogovan = data;
                                sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan));
                                $("#AllGood").html("Komentar je izmenjen");

                                sessionStorage.setItem("trenutniPrikaz", UserView);

                                $("#PageContent").html(UserView);

                            }
                        });
                    }
                } else { $("#Greske").html("Niste uneli komentar."); }
            });

            $(document).on("click", "[name='vozacMenjaVoznju']", function () {
                //
                var UserView = "";
                $("#Greske").empty();
                $("#AllGood").empty();

                var i = $(this).attr("id");
                
                var stat = ""; // CUPAM status 
                var delovi = i.split("_");
                var Id = { idVoznje: delovi[0] };
                stat = delovi[1];
                //
                if (Id != null) {
                   // var objekatSlanje = { idVoznje: idVoznje1 };
                    if (stat == "OBRADJENA") {
                        // PROMENI STANJE U PRIHVACENA
                        //var UserView = "Stanje voznje je sada prihvacena";
                        $.get("/api/ahome/vozacMenjaUuPrihvacena", Id, function (data, status) {
                            if (data != null) {
                                $("#AllGood").html("Uspesno promenjeno stanje u PRIHVACENA");
                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                $("#PageContent").html(UserView);
                               // sessionStorage.setItem("trentutnoUlogovan", data);
                                sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(data));
                            } else {
                                $("#Greske").html(data);
                            }
                        });
                    }
                    else if (stat == "PRIHVACENA") {
                        // PROMENI STANJE U U_TOKU
                        $.get("/api/ahome/vozacMenjaUuToku", Id, function (data, status) {
                            if (data != null) {
                                sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(data));
                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                $("#PageContent").html(UserView);
                                $("#AllGood").html("Uspesno promenjeno stanje u U TOKU");
                            } else {
                                $("#Greske").html(data);
                            }
                        });
                    }
                    else if (stat == "U")
                    {
                        // POMENI STANJE U USPESNA NEUSPESNA
                        /*UserView = "";
                        UserView += "<h2> Izaberite novo stanje izabrane vožnje </h2>";
                        UserView += "<table border=\"1\"> <tr> <td> <input type=\"submit\" name=\"Uspeh\" value=\"Uspešna\" id=\"USPEH" + "_" + delovi[0]  + "/> </td>";
                        UserView += "<td> <input type=\"submit\" name=\"Uspeh\" value=\"Neuspešna\" id=\"NEUSPEH" + "_" + delovi[0] + "/> </td> </tr> </table>";*/

                        //UserView += "<h2> Izaberite novo stanje izabrane vožnje </h2>";
                        UserView += "    <table align=\"center\"> <th colspan=\"2\"> <h2> Izaberite novo stanje izabrane vožnje </h2> </th> ";
                        UserView += "        <tr>";
                        UserView += "        <td align=\"center\">";
                        UserView += "            <input type=\"submit\" name=\"Uspeh\" value=\"Uspešna\" id=\"USPEH*"+delovi[0] +" \"/>";
                        UserView += "        </td>";
                        UserView += "<td align=\"center\">";
                        UserView += "    <input type=\"submit\" name=\"Uspeh\" value=\"Neuspešna\" id=\"NEUSPEH*" + delovi[0] +"\"/>";
                        UserView += "</td> ";
                        UserView += "</tr > ";
						
                        UserView += "</table > ";
                        sessionStorage.setItem("trenutniPrikaz", UserView);

                        $("#PageContent").html(UserView);

                    }
                }

            });

            $(document).on("click", "[name='Uspeh']", function () {
                // uzmi posalji funkciji USPEH/NE i id pa nek se ona snadje lakse ovde da imam jednu i tamo 1 funkciju 
                var UserView = "";
                $("#Greske").empty();
                $("#AllGood").empty();

                var Id = { s: $(this).attr("id") };
                var nesto = $(this).attr("id");

                var delovi = nesto.split('*');
                var stat = delovi[0];

                $.get("/api/ahome/vozacMenjaUspesnaNeuspesna", Id, function (data, status) {
                    if (data != null) {
                        $("#Greske").html("STATUS PROMENJEN");
                        sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(data));

                        if (stat == "USPEH") {
                            $("#AllGood").html("Uspesno promenjeno stanje u uspeh");
                            //NACRTAJ UNOS DESTINACIJE I IZNOS
                            $("#Greske").empty();

                            var UserView = "";
                            var UserMenu = "";

                            UserView += "<h2> Izaberite lokaciju na mapi </h2>";
                            UserView += map;
                            UserView += "<br/> Vasa lokacija je: ";
                            UserView += "   <table> <tr> <td id=\"kord\"> </td> </tr> </table>";
                            UserView += "<br/> Unesite iznos voznje: ";
                            UserView += "<input type=\"text\" id=\"iznos\" />";
                            //UserView += "<input type=\"hidden\" value=\"" + delovi[1] + "\" id=\"skriveno\" ";
                            UserView += "<input type=\"hidden\" id=\"skriveno\" value=\""+delovi[1]+"\">";
                            UserView += "<input type=\"submit\" value=\"Potvrdi\" id=\"unosKrajDest\"/>";

                            UserMenu = "<table align=\"center\">";
                            UserMenu += "  <tr> ";
                            UserMenu += "        <td id=\"CantLeave\"> Opcije </td>";
                            UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                            UserMenu += "        <td id=\"CantLeave\"> Pregled profila </td>";
                            UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                            UserMenu += "        <td id=\"CantLeave\"> Promena Lokacije </td>";
                            UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                            UserMenu += "        <td id=\"CantLeave\"> Izloguj se </td>";
                            UserMenu += "    </tr>";
                            UserMenu += "</table>";


                            sessionStorage.setItem("trenutniPrikaz", UserView);
                            $("#PageContent").html(UserView);
                            sessionStorage.setItem("trenutniMeni", UserMenu);
                            $("#PageMenu").html(UserMenu);
                            //

                        } else {
                            $("#AllGood").html("Uspesno promenjeno stanje u neuspeh");

                        }

                        $("#PageContent").html(UserView);
                        sessionStorage.setItem("trenutniPrikaz", UserView);
                    } else {
                        $("#Greske").html(data);
                    }
                });
            });

            $(document).on("click", "#CantLeave", function () {
                $("#Greske").html("Morate selektovati lokaciju i uneti cenu pre nastavka");
            });

            $(document).on("click", "#unosKrajDest", function () {
                var UserView = "";
                var UserMenu = "";

                $("#Greske").empty();
                $("#AllGood").empty();

                var iznos = $("#iznos").val();


                if ($("#kord").val() != null && xx != null) { // onda saljemo 
                    //
                    if (iznos != null && iznos != "") {

                        var objekat = {
                            Odrediste: {
                                Xcoordinate: xx,
                                Ycoordinate: yy,
                                Adresa: {
                                    UlicaBroj: ulica_broj,
                                    MestoPostanski: grad
                                }
                            },
                            Iznos: $("#iznos").val(),
                            Id: $("#skriveno").val()
                        };
                        //
                        $.post("/api/ahome/vozacOdredisteCena", objekat, function (data, status) {
                            if (data.UserName == null || data.UserName == "") {
                                // VRATIM VOZACA CIJA JE VOZNJA
                                $("#Greske").html(data);

                            } else {
                                $("#AllGood").html("Uspešno postavljen iznos i odredište");
                                trenutnoUlogovan = data;

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcijeVozaca\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profilVozaca\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"promenaLokacije\"> Promena Lokacije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";

                                sessionStorage.setItem("trenutniMeni", UserMenu);
                                $("#PageMenu").html(UserMenu);
                                sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(data));
                            }
                        });
                    } else {
                        $("#Greske").html("Niste uneli iznos");
                    }

                    //

                } else {
                    $("#Greske").html("Lokacija nije uneta. Molimo vas unesite lokaciju");
                }


            });

            $(document).on("click", "#prikazSvihVoznji", function () {
                var UserView = "";
                var UserMenu = "";

                $("#Greske").empty();
                $("#AllGood").empty();

                $.get("/api/ahome/vratiSve", function (data, status) {
                    if (data != null) {
                        $("#AllGood").html("Pokupio sve voznje");
                        //ispisi sve voznje
                        UserView = " <br/> ";
                        UserView += "<input type=\"submit\" value=\"Prikazi sve voznje\" id=\"prikazSvihVoznji\"/>";
                        UserView += "<input type=\"submit\" value=\"Prikazi samo moje vožnje\" id=\"prikazAdminovihVoznji\"/>";
                        UserView += "    <table border=\"1\">";
                        UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"2\"> </th>  </tr>";

                        var voznjeTrenutne = data;
                        sessionStorage.setItem("trenutneVoznje", JSON.stringify(voznjeTrenutne));

                        for (v in data) {
                            // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                            UserView += "<tr> <td> " + data[v].LokacijaPolazna.Adresa.UlicaBroj + " " + data[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";

                            if (data[v].Odrediste != null) {
                                if (data[v].Odrediste.Adresa.UlicaBroj != null) {
                                    UserView += " <td> " + data[v].Odrediste.Adresa.UlicaBroj + " ";
                                }
                                else { UserView += "<td> "; }
                                if (data[v].Odrediste.Adresa.MestoPostanski != null) {
                                    UserView += data[v].Odrediste.Adresa.MestoPostanski + " </td>";
                                } else {
                                    UserView += " </td>";
                                }
                            } else { UserView += " <td></td>"; }

                            if (data[v].Musterija != null) {
                                UserView += "<td>" + data[v].Musterija + "  </td>";
                            } else {
                                UserView += "<td></td>";
                            }

                            if (data[v].Vozac == null || data[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                            else { UserView += "<td>" + data[v].Vozac + " </td> " }

                            if (data[v].Dispatcher == null || data[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                            else { UserView += "<td>" + data[v].Dispatcher + " </td> " }

                            var dodeli = "<td> </td>";
                            var pomstat = "";

                            //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                            if (data[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + data[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                            if (data[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + data[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                            if (data[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                            if (data[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                            if (data[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                            if (data[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                            if (data[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                            if (data[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                            //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                            UserView += "<td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + data[v].Id + " /> </td>" + dodeli + "</tr > ";

                        }
                        UserView += "    </table>";
                        UserView += " <p> Pretraga po statusu </p>";
                        UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                        UserView += "   <option value=\"0\">KREIRANA</option>";
                        UserView += "    <option value=\"1\">FORMIRANA</option>";
                        UserView += "    <option value=\"2\">OBRADJENA</option>";
                        UserView += "    <option value=\"3\">PRIHVACENA</option>";
                        UserView += "    <option value=\"4\">OTKAZANA</option>";
                        UserView += "    <option value=\"5\">NEUSPESNA</option>";
                        UserView += "    <option value=\"6\">USPESNA</option>";
                        UserView += "    <option value=\"7\">U_TOKU</option>";
                        UserView += "</select> <br/> <br/>";

                        UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                        UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                        UserView += "    <br/> Unesite kriterijume pretrage <br/><br/> ";

                        UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                        UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                        //UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                        //                                UserView += "     <br/>Pretražite po oceni <br/> ";
                        UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                        UserView += "   <select name=\"OceneMin\" size=\"1\">";
                        UserView += "        <option value=\"0\">0</option>";
                        UserView += "        <option value=\"1\">1</option>";
                        UserView += "        <option value=\"2\">2</option>";
                        UserView += "        <option value=\"3\">3</option>";
                        UserView += "        <option value=\"4\">4</option>";
                        UserView += "        <option value=\"5\">5</option>";
                        UserView += "    </select> <br/>";

                        UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                        UserView += "    <select name=\"OceneMax\" size=\"1\">";
                        UserView += "        <option value=\"0\">0</option>";
                        UserView += "         <option value=\"1\">1</option>";
                        UserView += "        <option value=\"2\">2</option>";
                        UserView += "        <option value=\"3\">3</option>";
                        UserView += "        <option value=\"4\">4</option>";
                        UserView += "        <option value=\"5\">5</option>";
                        UserView += "    </select> <br/>";

                        //UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                        //UserView += "   <p> <br/>Pretraga po ceni </p>";
                        UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                        UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                        //UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                        //UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu korisnika </p>";
                        UserView += " <br/>Ime korisnika: <br/>";
                        UserView += "<input type=\"text\" id=\"imeZaPretragu\" />";

                        UserView += " <br/>Prezime korisnika: <br/>";
                        UserView += "<input type=\"text\" id=\"prezimeZaPretragu\" />";
                        //UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"pretrazikorisnike\" value=\"Pretraži korisnike\" />";

                        // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu vozača </p>";
                        UserView += " <br/>Ime vozača: <br/>";
                        UserView += "<input type=\"text\" id=\"vimeZaPretragu\" />";

                        UserView += " <br/>Prezime vozača: <br/>";
                        UserView += "<input type=\"text\" id=\"vprezimeZaPretragu\" />";
                        UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"izvrsipretragu\" value=\"Pretraži\" />";


                        sessionStorage.setItem("trenutniPrikaz", UserView);

                        $("#PageContent").html(UserView);
                        //
                    }
                });

            });

            $(document).on("click", "#prikazAdminovihVoznji", function () {
                var UserView = "";
                var UserMenu = "";

                $("#Greske").empty();
                $("#AllGood").empty();

                var trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));
                var voznjeTrenutne = trenutnoUlogovan.Voznje;
                sessionStorage.setItem("trenutneVoznje", JSON.stringify(voznjeTrenutne));

                UserView = " <br/> ";
                UserView += "<input type=\"submit\" value=\"Prikazi sve vožnje\" id=\"prikazSvihVoznji\"/>";
                UserView += "<input type=\"submit\" value=\"Prikazi samo moje vožnje\" id=\"prikazAdminovihVoznji\"/>";
                UserView += "    <table border=\"1\">";
                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"2\"> </th>  </tr>";

                for (v in trenutnoUlogovan.Voznje) {
                    // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija + " " + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Vozac + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                    // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                    UserView += "<tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";

                    if (trenutnoUlogovan.Voznje[v].Odrediste != null) {

                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj != null) {
                            UserView += " <td> " + trenutnoUlogovan.Voznje[v].Odrediste.Adresa.UlicaBroj + " ";
                        }
                        else { UserView += "<td> "; }
                        if (trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski != null) {
                            UserView += trenutnoUlogovan.Voznje[v].Odrediste.Adresa.MestoPostanski + " </td>";
                        } else {
                            UserView += " </td>";
                        }
                    } else { UserView += "<td></td> "}


                    if (trenutnoUlogovan.Voznje[v].Musterija != null) {
                        UserView += "<td>" + trenutnoUlogovan.Voznje[v].Musterija + "  </td >";
                    } else {
                        UserView += "<td> </td>";
                    }

                    if (trenutnoUlogovan.Voznje[v].Vozac == null || trenutnoUlogovan.Voznje[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                    else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Vozac + " </td> " }

                    if (trenutnoUlogovan.Voznje[v].Dispatcher == null || trenutnoUlogovan.Voznje[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                    else { UserView += "<td>" + trenutnoUlogovan.Voznje[v].Dispatcher + " </td> " }

                    var dodeli = "<td> </td>";
                    var pomstat = "";

                    //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + trenutnoUlogovan.Voznje[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                    if (trenutnoUlogovan.Voznje[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                    //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                    UserView += " <td> <input type=\"submit\" name=\"AdminPregledajvoznju\" value=\"Pregledaj\" id=" + trenutnoUlogovan.Voznje[v].Id + " /> </td>" + dodeli + "</tr > ";
                }
                UserView += "    </table>";
                UserView += " <p> Pretraga po statusu </p>";
                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                UserView += "   <option value=\"0\">KREIRANA</option>";
                UserView += "    <option value=\"1\">FORMIRANA</option>";
                UserView += "    <option value=\"2\">OBRADJENA</option>";
                UserView += "    <option value=\"3\">PRIHVACENA</option>";
                UserView += "    <option value=\"4\">OTKAZANA</option>";
                UserView += "    <option value=\"5\">NEUSPESNA</option>";
                UserView += "    <option value=\"6\">USPESNA</option>";
                UserView += "    <option value=\"7\">U_TOKU</option>";
                UserView += "</select> <br/> <br/>";

                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                UserView += "    <br/> Unesite parametre pretrage <br/> <br/> ";

                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime - local\" /> <br />";
                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime - local\" /> <br />";
                //UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                // UserView += "     <br/>Pretražite po oceni <br/> ";
                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                UserView += "        <option value=\"0\">0</option>";
                UserView += "        <option value=\"1\">1</option>";
                UserView += "        <option value=\"2\">2</option>";
                UserView += "        <option value=\"3\">3</option>";
                UserView += "        <option value=\"4\">4</option>";
                UserView += "        <option value=\"5\">5</option>";
                UserView += "    </select> <br/>";

                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                UserView += "        <option value=\"0\">0</option>";
                UserView += "         <option value=\"1\">1</option>";
                UserView += "        <option value=\"2\">2</option>";
                UserView += "        <option value=\"3\">3</option>";
                UserView += "        <option value=\"4\">4</option>";
                UserView += "        <option value=\"5\">5</option>";
                UserView += "    </select> <br/>";

                //UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                // UserView += "   <p> <br/>Pretraga po ceni </p>";
                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                //UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu korisnika </p>";
                UserView += " <br/>Ime korisnika: <br/>";
                UserView += "<input type=\"text\" id=\"imeZaPretragu\" />";

                UserView += " <br/>Prezime korisnika: <br/>";
                UserView += "<input type=\"text\" id=\"prezimeZaPretragu\" />";
                //UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"pretrazikorisnike\" value=\"Pretraži korisnike\" />";

                // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu vozača </p>";
                UserView += " <br/>Ime vozača: <br/>";
                UserView += "<input type=\"text\" id=\"vimeZaPretragu\" />";

                UserView += " <br/>Prezime vozača: <br/>";
                UserView += "<input type=\"text\" id=\"vprezimeZaPretragu\" />";
                UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"izvrsiPretragu\" value=\"Pretraži\" />";

                sessionStorage.setItem("trenutniPrikaz", UserView);

                $("#PageContent").html(UserView);

            });

            $(document).on("click", "#dateSort", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                var trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));

                var UserMenu = "";
                var UserView = "";

                var voznjeTrenutne = JSON.parse(sessionStorage.getItem("trenutneVoznje"));
                var object = { PoslateVoznje: voznjeTrenutne };

                //datesort
                $.post("/api/ahome/datesort", object, function (data, status) {
                    if (data == null) {
                        $("#Greske").html("Greška u sistemu");
                    } else {

                        var voznjeTrenutne = data;
                        sessionStorage.setItem("trenutneVoznje", JSON.stringify(voznjeTrenutne));

                        UserView = " <br/> ";
                        UserView += "<input type=\"submit\" value=\"Prikazi sve vožnje\" id=\"prikazSvihVoznji\"/>";
                        UserView += "<input type=\"submit\" value=\"Prikazi samo moje vožnje\" id=\"prikazAdminovihVoznji\"/>";
                        UserView += "    <table border=\"1\">";
                        UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"2\"> </th>  </tr>";

                        for (v in voznjeTrenutne) {
                            // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija + " " + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Vozac + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                            // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                            UserView += "<tr> <td> " + voznjeTrenutne[v].LokacijaPolazna.Adresa.UlicaBroj + " " + voznjeTrenutne[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";

                            if (voznjeTrenutne[v].Odrediste != null) {
                                if (voznjeTrenutne[v].Odrediste.Adresa != null) {
                                    if (voznjeTrenutne[v].Odrediste.Adresa.UlicaBroj != null) {
                                        UserView += " <td> " + voznjeTrenutne[v].Odrediste.Adresa.UlicaBroj + " ";
                                    }
                                    else { UserView += "<td> "; }
                                    if (voznjeTrenutne[v].Odrediste.Adresa.MestoPostanski != null) {
                                        UserView += voznjeTrenutne[v].Odrediste.Adresa.MestoPostanski + " </td>";
                                    } else {
                                        UserView += " </td>";
                                    }
                                } else { UserView += "<td></td> "; }
                            } else { UserView += "<td></td> "; }


                            if (voznjeTrenutne[v].Musterija != null) {
                                UserView += "<td>" + voznjeTrenutne[v].Musterija + "  </td >";
                            } else {
                                UserView += "<td> </td>";
                            }

                            if (voznjeTrenutne[v].Vozac == null || voznjeTrenutne[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                            else { UserView += "<td>" + voznjeTrenutne[v].Vozac + " </td> " }

                            if (voznjeTrenutne[v].Dispatcher == null || voznjeTrenutne[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                            else { UserView += "<td>" + voznjeTrenutne[v].Dispatcher + " </td> " }

                            var dodeli = "<td> </td>";
                            var pomstat = "";

                            //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                            if (voznjeTrenutne[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + voznjeTrenutne[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                            if (voznjeTrenutne[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + voznjeTrenutne[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                            if (voznjeTrenutne[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                            //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                            UserView += " <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + voznjeTrenutne[v].Id + " /> </td>" + dodeli + "</tr > ";
                        }
                        UserView += "    </table>";
                        UserView += " <p> Pretraga po statusu </p>";
                        UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                        UserView += "   <option value=\"0\">KREIRANA</option>";
                        UserView += "    <option value=\"1\">FORMIRANA</option>";
                        UserView += "    <option value=\"2\">OBRADJENA</option>";
                        UserView += "    <option value=\"3\">PRIHVACENA</option>";
                        UserView += "    <option value=\"4\">OTKAZANA</option>";
                        UserView += "    <option value=\"5\">NEUSPESNA</option>";
                        UserView += "    <option value=\"6\">USPESNA</option>";
                        UserView += "    <option value=\"7\">U_TOKU</option>";
                        UserView += "</select> <br/> <br/>";

                        UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                        UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                        UserView += "    <br/> Unesite parametre pretrage <br/> <br/> ";

                        UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime - local\" /> <br />";
                        UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime - local\" /> <br />";
                        //UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                        // UserView += "     <br/>Pretražite po oceni <br/> ";
                        UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                        UserView += "   <select name=\"OceneMin\" size=\"1\">";
                        UserView += "        <option value=\"0\">0</option>";
                        UserView += "        <option value=\"1\">1</option>";
                        UserView += "        <option value=\"2\">2</option>";
                        UserView += "        <option value=\"3\">3</option>";
                        UserView += "        <option value=\"4\">4</option>";
                        UserView += "        <option value=\"5\">5</option>";
                        UserView += "    </select> <br/>";

                        UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                        UserView += "    <select name=\"OceneMax\" size=\"1\">";
                        UserView += "        <option value=\"0\">0</option>";
                        UserView += "         <option value=\"1\">1</option>";
                        UserView += "        <option value=\"2\">2</option>";
                        UserView += "        <option value=\"3\">3</option>";
                        UserView += "        <option value=\"4\">4</option>";
                        UserView += "        <option value=\"5\">5</option>";
                        UserView += "    </select> <br/>";

                        //UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                        // UserView += "   <p> <br/>Pretraga po ceni </p>";
                        UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                        UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                        //UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                        // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu korisnika </p>";
                        UserView += " <br/>Ime korisnika: <br/>";
                        UserView += "<input type=\"text\" id=\"imeZaPretragu\" />";

                        UserView += " <br/>Prezime korisnika: <br/>";
                        UserView += "<input type=\"text\" id=\"prezimeZaPretragu\" />";
                        //UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"pretrazikorisnike\" value=\"Pretraži korisnike\" />";

                        // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu vozača </p>";
                        UserView += " <br/>Ime vozača: <br/>";
                        UserView += "<input type=\"text\" id=\"vimeZaPretragu\" />";

                        UserView += " <br/>Prezime vozača: <br/>";
                        UserView += "<input type=\"text\" id=\"vprezimeZaPretragu\" />";
                        UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"izvrsiPretragu\" value=\"Pretraži\" />";

                        sessionStorage.setItem("trenutniPrikaz", UserView);

                        $("#PageContent").html(UserView);
                    }
                });

                });

                //sessionStorage.setItem("trenutneVoznje", JSON.stringify(voznjeTrenutne)); 

            $(document).on("click", "#gradeSort", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                var trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));
                var UserMenu = "";
                var UserView = "";
                var voznjeTrenutne = JSON.parse(sessionStorage.getItem("trenutneVoznje"));
                var object = { PoslateVoznje: voznjeTrenutne };

                $.post("/api/ahome/gradeSort", object, function (data, status) {
                    if (data == null) {
                        $("#Greske").html("Greška u sistemu");
                    } else {

                        var voznjeTrenutne = data;
                        sessionStorage.setItem("trenutneVoznje", JSON.stringify(voznjeTrenutne));

                        UserView = " <br/> ";
                        UserView += "<input type=\"submit\" value=\"Prikazi sve vožnje\" id=\"prikazSvihVoznji\"/>";
                        UserView += "<input type=\"submit\" value=\"Prikazi samo moje vožnje\" id=\"prikazAdminovihVoznji\"/>";
                        UserView += "    <table border=\"1\">";
                        UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th colspan=\"2\"> </th>  </tr>";

                        for (v in voznjeTrenutne) {
                            // UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.UlicaBroj + " " + trenutnoUlogovan.Voznje[v].LokacijaPolazna.Adresa.MestoPostanski + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija + " " + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Vozac + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                            // UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija + " " + data.Voznje[v].Vozac + "</td> <td>" + data.Voznje[v].Dispatcher + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                            UserView += "<tr> <td> " + voznjeTrenutne[v].LokacijaPolazna.Adresa.UlicaBroj + " " + voznjeTrenutne[v].LokacijaPolazna.Adresa.MestoPostanski + " </td>";

                            if (voznjeTrenutne[v].Odrediste != null) {
                                if (voznjeTrenutne[v].Odrediste.Adresa != null) {
                                    if (voznjeTrenutne[v].Odrediste.Adresa.UlicaBroj != null) {
                                        UserView += " <td> " + voznjeTrenutne[v].Odrediste.Adresa.UlicaBroj + " ";
                                    }
                                    else { UserView += "<td> "; }
                                    if (voznjeTrenutne[v].Odrediste.Adresa.MestoPostanski != null) {
                                        UserView += voznjeTrenutne[v].Odrediste.Adresa.MestoPostanski + " </td>";
                                    } else {
                                        UserView += " </td>";
                                    }
                                } else { UserView += "<td></td> "; }
                            } else { UserView += "<td></td> "; }


                            if (voznjeTrenutne[v].Musterija != null) {
                                UserView += "<td>" + voznjeTrenutne[v].Musterija + "  </td >";
                            } else {
                                UserView += "<td> </td>";
                            }

                            if (voznjeTrenutne[v].Vozac == null || voznjeTrenutne[v].Vozac == "") { UserView += "<td>" + " " + "</td>"; }
                            else { UserView += "<td>" + voznjeTrenutne[v].Vozac + " </td> " }

                            if (voznjeTrenutne[v].Dispatcher == null || voznjeTrenutne[v].Dispatcher == "") { UserView += "<td>" + " " + "</td>"; }
                            else { UserView += "<td>" + voznjeTrenutne[v].Dispatcher + " </td> " }

                            var dodeli = "<td> </td>";
                            var pomstat = "";

                            //{KREIRANA,FORMIRANA,OBRADJENA,PRIHVACENA,OTKAZANA,NEUSPESNA,USPESNA,U_TOKU}
                            if (voznjeTrenutne[v].StatusVoznje == 0) { UserView += "<td>KREIRANA</td>"; pomstat = "KREIRANA"; dodeli = "<td> <input type=\"submit\" id=" + voznjeTrenutne[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                            if (voznjeTrenutne[v].StatusVoznje == 1) { UserView += "<td>FORMIRANA</td>"; pomstat = "FORMIRANA"; dodeli = "<td> <input type=\"submit\" id=" + voznjeTrenutne[v].Id + " name=\"adminDodeliVoznji\" value=\"Dodeli\"/></td>"; }
                            if (voznjeTrenutne[v].StatusVoznje == 2) { UserView += "<td>OBRADJENA</td>"; pomstat = "OBRADJENA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 3) { UserView += "<td>PRIHVACENA</td>"; pomstat = "PRIHVACENA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 4) { UserView += "<td>OTKAZANA</td>"; pomstat = "OTKAZANA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 5) { UserView += "<td>NEUSPESNA</td>"; pomstat = "NEUSPESNA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 6) { UserView += "<td>USPESNA</td>"; pomstat = "USPESNA"; }
                            if (voznjeTrenutne[v].StatusVoznje == 7) { UserView += "<td>U_TOKU</td>"; pomstat = "U_TOKU"; }

                            //<input type=\"submit\" name=\"detalji_voznje\" id=\"" + login_user.Voznje[t].Id + "\" value=\"Detalji voznje\" />

                            UserView += " <td> <input type=\"submit\" name=\"Pregledajvoznju\" value=\"Pregledaj\" id=" + voznjeTrenutne[v].Id + " /> </td>" + dodeli + "</tr > ";
                        }
                        UserView += "    </table>";
                        UserView += " <p> Pretraga po statusu </p>";
                        UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                        UserView += "   <option value=\"0\">KREIRANA</option>";
                        UserView += "    <option value=\"1\">FORMIRANA</option>";
                        UserView += "    <option value=\"2\">OBRADJENA</option>";
                        UserView += "    <option value=\"3\">PRIHVACENA</option>";
                        UserView += "    <option value=\"4\">OTKAZANA</option>";
                        UserView += "    <option value=\"5\">NEUSPESNA</option>";
                        UserView += "    <option value=\"6\">USPESNA</option>";
                        UserView += "    <option value=\"7\">U_TOKU</option>";
                        UserView += "</select> <br/> <br/>";

                        UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                        UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                        UserView += "    <br/> Unesite parametre pretrage <br/> <br/> ";

                        UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime - local\" /> <br />";
                        UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime - local\" /> <br />";
                        //UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                        // UserView += "     <br/>Pretražite po oceni <br/> ";
                        UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                        UserView += "   <select name=\"OceneMin\" size=\"1\">";
                        UserView += "        <option value=\"0\">0</option>";
                        UserView += "        <option value=\"1\">1</option>";
                        UserView += "        <option value=\"2\">2</option>";
                        UserView += "        <option value=\"3\">3</option>";
                        UserView += "        <option value=\"4\">4</option>";
                        UserView += "        <option value=\"5\">5</option>";
                        UserView += "    </select> <br/>";

                        UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                        UserView += "    <select name=\"OceneMax\" size=\"1\">";
                        UserView += "        <option value=\"0\">0</option>";
                        UserView += "         <option value=\"1\">1</option>";
                        UserView += "        <option value=\"2\">2</option>";
                        UserView += "        <option value=\"3\">3</option>";
                        UserView += "        <option value=\"4\">4</option>";
                        UserView += "        <option value=\"5\">5</option>";
                        UserView += "    </select> <br/>";

                        //UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                        // UserView += "   <p> <br/>Pretraga po ceni </p>";
                        UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                        UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                        //UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                        // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu korisnika </p>";
                        UserView += " <br/>Ime korisnika: <br/>";
                        UserView += "<input type=\"text\" id=\"imeZaPretragu\" />";

                        UserView += " <br/>Prezime korisnika: <br/>";
                        UserView += "<input type=\"text\" id=\"prezimeZaPretragu\" />";
                        //UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"pretrazikorisnike\" value=\"Pretraži korisnike\" />";

                        // UserView += "<p> <br/>Pretraga po imenu i/ili prezimenu vozača </p>";
                        UserView += " <br/>Ime vozača: <br/>";
                        UserView += "<input type=\"text\" id=\"vimeZaPretragu\" />";

                        UserView += " <br/>Prezime vozača: <br/>";
                        UserView += "<input type=\"text\" id=\"vprezimeZaPretragu\" />";
                        UserView += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=\"submit\" id=\"izvrsiPretragu\" value=\"Pretraži\" />";

                        sessionStorage.setItem("trenutniPrikaz", UserView);

                        $("#PageContent").html(UserView);
                    }
                });

            });
            // ako je zauzet ne moze da promeni da stavi da je neka voznja u toku 
        });
    </script>
</head>



<body>

    <div class="Baner" id="PageBanner">
        Taksi služba
    </div>

    <div id="PageMenu" class="Meni">
        <table align="center">
            <tr>
                <td id="logovanje"> Uloguj se </td>
                <td>&nbsp; &nbsp; &nbsp;</td>
                <td id="registracija"> Registruj se </td>
            </tr>
        </table>
    </div>
    <br /><br /><br />

    <div id="PageContent">
        <table>
            <tr>
                <td> Korisničko ime </td>
                <td> <input type="text" id="Username" /> </td>
            </tr>
            <tr>
                <td> Lozinka </td>
                <td> <input type="password" id="Password" /> </td>
            </tr>
            <tr>
                <td> <input type="button" value="Uloguj se" id="logovanjeButton" /></td>
            </tr>
        </table>
    </div>

    <div id="Greske" class="Bad">
    </div>

    <div id="AllGood" class="Good">
    </div>


</body>
</html>

