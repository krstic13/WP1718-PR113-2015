<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" type="text/css" href="Stilovi.css" />
    <meta charset="utf-8" />
    <title></title>


    <script src="/Scripts/jquery-1.10.2.js"></script>
    <script>
        $(document).ready(function () {
            var trenutnoUlogovan;
            var UserMenu;
            var UserView;

            if (sessionStorage.getItem("trenutniPrikaz") != null) {
                $("#PageContent").html(sessionStorage.getItem("trenutniPrikaz"));
            }

            if (sessionStorage.getItem("trenutniMeni") != null) {
                $("#PageMenu").html(sessionStorage.getItem("trenutniMeni"));
            }

            if (sessionStorage.getItem("ulogovaniKorisnik") != null) {
                trenutnoUlogovan = JSON.parse(sessionStorage.getItem("ulogovaniKorisnik"));
            }


            $(document).on("click", "#logovanje", function () {

                $("#Greske").empty();
                $("#AllGood").empty();

                UserView = "<table>";
                UserView += "    <tr>";
                UserView += "        <td> Korisničko ime </td>";
                UserView += "        <td> <input type=\"text\" id=\"Username\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> Lozinka </td>";
                UserView += "        <td> <input type=\"password\" id=\"Password\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> <input type=\"button\" value=\"Uloguj se\" id=\"logovanjeButton\" /></td>";
                UserView += "    </tr>";
                UserView += "</table>";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#logovanjeButton", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                if ($("#Username").val() != "" && $("#Password").val() != "")
                {
                    var objekat = { Username: $("#Username").val(), Password: $("#Password").val() };
                    $.get("/api/ahome/login", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            sessionStorage.setItem("ulogovaniKorisnik", JSON.stringify(trenutnoUlogovan)); //  sessionStorage.removeItem("ulogovaniKorisnik");
                            //sessionStorage.getItem("ulogovaniKorisnik");
                            //log, logout i update
                           
                            if (data.Uloga == 0) {
                                // KORISNIK 
                                UserView = " <br/> ";
                                UserView += "    <table border=\"1\">";
                                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th> </th> <th> </th> </tr>";

                                for(v in data.Voznje)
                                {
                                    UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija.LastName + "  </td > <td> " + data.Voznje[v].Name + " " + data.Voznje[v].Vozac.LastName + "</td> <td>" + data.Voznje[v].Dispatcher.Name + " " + data.Voznje[v].Dispatcher.LastName + "</td> <td>" + data.Voznje[v].StatusVoznje +" </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                                }
                                UserView += "    </table>";
                                //UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>"; ovo vidi vozaccc
                                UserView += " <p> Pretraga po statusu </p>";
                                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                                UserView += "   <option value=\"1\">KREIRANA</option>";
                                UserView += "    <option value=\"2\">FORMIRANA</option>";
                                UserView += "    <option value=\"3\">OBRADJENA</option>";
                                UserView += "    <option value=\"4\">PRIHVACENA</option>";
                                UserView += "    <option value=\"5\">OTKAZANA</option>";
                                UserView += "    <option value=\"6\">NEUSPESNA</option>";
                                UserView += "    <option value=\"8\">USPESNA</option>";
                                UserView += "    <option value=\"8\">U_TOKU</option>";
                                UserView += "</select> <br/> <br/>"; 

                                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                                UserView += "    <br/> Pretražite po datumu <br/> ";

                                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime - local\" /> <br />";
                                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime - local\" /> <br />";
                                UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                                UserView += "     <br/>Pretražite po oceni <br/> ";
                                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>"; 
                                UserView += "        <option value=\"1\">1</option>"; 
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>"; 
                                UserView += "         <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                                UserView += "   <p> <br/>Pretraga po ceni </p>";
                                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                                UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcije\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profil\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"novaVoznja\"> Nova vožnja </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";


                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                sessionStorage.setItem("trenutniMeni", UserMenu);

                                $("#PageContent").html(UserView);
                                $("#PageMenu").html(UserMenu);

                            }
                            else if (data.Uloga == 1) {
                                //  DRIVER

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcijeVozaca\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profilVozaca\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";
                                //
                                UserView = "<h2> Vožnje </h2> ";
                                UserView += "    <table border=\"1\">";
                                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th> </th> <th> </th> </tr>";

                                for (v in data.Voznje) {
                                    UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija.LastName + "  </td > <td> " + data.Voznje[v].Name + " " + data.Voznje[v].Vozac.LastName + "</td> <td>" + data.Voznje[v].Dispatcher.Name + " " + data.Voznje[v].Dispatcher.LastName + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                                }
                                UserView += "    </table>";
                                UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>"; 
                                UserView += " <p> Pretraga po statusu </p>";
                                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                                UserView += "   <option value=\"1\">KREIRANA</option>";
                                UserView += "    <option value=\"2\">FORMIRANA</option>";
                                UserView += "    <option value=\"3\">OBRADJENA</option>";
                                UserView += "    <option value=\"4\">PRIHVACENA</option>";
                                UserView += "    <option value=\"5\">OTKAZANA</option>";
                                UserView += "    <option value=\"6\">NEUSPESNA</option>";
                                UserView += "    <option value=\"8\">USPESNA</option>";
                                UserView += "    <option value=\"8\">U_TOKU</option>";
                                UserView += "</select> <br/> <br/>";

                                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                                UserView += "    <br/> Pretražite po datumu <br/> ";

                                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime - local\" /> <br />";
                                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime - local\" /> <br />";
                                UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                                UserView += "     <br/>Pretražite po oceni <br/> ";
                                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "        <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "         <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                                UserView += "   <p> <br/>Pretraga po ceni </p>";
                                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                                UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                                UserView += "    <input type=\"submit\" value=\"Sortiraj po udaljenosti\" id=\"sortirajPoUdaljenosti\"/>";  // sortira tabelu po

                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                sessionStorage.setItem("trenutniMeni", UserMenu);

                                $("#PageContent").html(UserView);
                                $("#PageMenu").html(UserMenu);
                                //
                            }
                            else if (data.Uloga == 2) {
                                // ADMIN
                                UserView = " <br/> ";
                                UserView += "    <table border=\"1\">";
                                UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th> </th> <th> </th> </tr>";

                                for (v in data.Voznje) {
                                    UserView += "   <tr> <td> " + data.Voznje[v] + " </td> <td>" + data.Voznje[v].Odrediste + " </td> <td>" + data.Voznje[v].Musterija.Name + " " + data.Voznje[v].Musterija.LastName + "  </td > <td> " + data.Voznje[v].Name + " " + data.Voznje[v].Vozac.LastName + "</td> <td>" + data.Voznje[v].Dispatcher.Name + " " + data.Voznje[v].Dispatcher.LastName + "</td> <td>" + data.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                                }
                                UserView += "    </table>";
                                //UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>"; ovo vidi vozaccc
                                UserView += " <p> Pretraga po statusu </p>";
                                UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                                UserView += "   <option value=\"1\">KREIRANA</option>";
                                UserView += "    <option value=\"2\">FORMIRANA</option>";
                                UserView += "    <option value=\"3\">OBRADJENA</option>";
                                UserView += "    <option value=\"4\">PRIHVACENA</option>";
                                UserView += "    <option value=\"5\">OTKAZANA</option>";
                                UserView += "    <option value=\"6\">NEUSPESNA</option>";
                                UserView += "    <option value=\"8\">USPESNA</option>";
                                UserView += "    <option value=\"8\">U_TOKU</option>";
                                UserView += "</select> <br/> <br/>";

                                UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                                UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                                UserView += "    <br/> Pretražite po datumu <br/> ";

                                UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime - local\" /> <br />";
                                UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime - local\" /> <br />";
                                UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                                UserView += "     <br/>Pretražite po oceni <br/> ";
                                UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                                UserView += "   <select name=\"OceneMin\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "        <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                                UserView += "    <select name=\"OceneMax\" size=\"1\">";
                                UserView += "        <option value=\"0\">0</option>";
                                UserView += "         <option value=\"1\">1</option>";
                                UserView += "        <option value=\"2\">2</option>";
                                UserView += "        <option value=\"3\">3</option>";
                                UserView += "        <option value=\"4\">4</option>";
                                UserView += "        <option value=\"5\">5</option>";
                                UserView += "    </select> <br/>";

                                UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                                UserView += "   <p> <br/>Pretraga po ceni </p>";
                                UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                                UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                                UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                                UserMenu = "<table align=\"center\">";
                                UserMenu += "  <tr> ";
                                UserMenu += "        <td id=\"opcije\"> Opcije </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"profil\"> Pregled profila </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"novaVoznja\"> Nova vožnja </td>";
                                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                                UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                                UserMenu += "    </tr>";
                                UserMenu += "</table>";


                                sessionStorage.setItem("trenutniPrikaz", UserView);
                                sessionStorage.setItem("trenutniMeni", UserMenu);

                                $("#PageContent").html(UserView);
                                $("#PageMenu").html(UserMenu);
                            }
                        }
                    });

                } else {
                    $("#Greske").html("Pogrešan unos lozinke ili korisničkog imena");
                }

            });

            $(document).on("click", "#registracija", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                UserView = "    <table>";
                UserView += "    <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" /></td> </tr > ";
                UserView += "        <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" /> </td> </tr>";
                UserView += "        <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" /></td> </tr>";
                UserView += "        <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" /> </td> </tr>";
                UserView += "        <tr> <td> Pol: </td> <td>";
                UserView += "            <select name=\"Pol\" id=\"pol\" size=\"1\">";
                UserView += "               <option value=\"1\">Žensko</option>";
                UserView += "               <option value=\"2\" selected>Muško</option>";
                UserView += "            </select>";
                UserView += "       </td> </tr>";
                UserView += "        <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" /> </td> </tr>";
                UserView += "        <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" /> </td> </tr>";
                UserView += "        <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" /> </td> </tr>";
                UserView += "<tr><td colspan='2' align='center'> <input type=\"submit\" value='Potvrda Registracije' id=\"potvrdaRegistracije\"/></td></tr>";
                UserView += " </table >";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#potvrdaRegistracije", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                // postaje musterija
                if ($("#korisnickoIme").val() != "" && $("#korisnickaLozinka").val() != ""
                    && $("#Ime").val() != "" && $("#Prezime").val() != "" && $("#korisnickiJMBG").val() != "" && $("#korisnickiTelefon").val() != "" && $("#korisnickiEmail").val() != "")
                {
                    var objekat = {
                        UserName: $("#korisnickoIme").val(), Password: $("#korisnickaLozinka").val(), Name: $("#Ime").val(), LastName: $("#Prezime").val(),
                        Gender: $("#pol").val(), JMBG: $("#korisnickiJMBG").val(), PhoneNumber: $("#korisnickiTelefon").val(), Email: $("#korisnickiEmail").val() };

                    $.post("/api/ahome/registration", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        }
                        else {
                            UserView = " <table> ";
                            UserView += "   <tr>";
                            UserView += "       <td> Korisničko ime </td>";
                            UserView += "       <td> <input type=\"text\" id=\"Username\" /> </td>";
                            UserView += "    </tr>";
                            UserView += "    <tr>";
                            UserView += "        <td> Lozinka </td>";
                            UserView += "        <td> <input type=\"password\" id=\"Password\" /> </td>";
                            UserView += "    </tr>";
                            UserView += "    <tr>";
                            UserView += "        <td> <input type=\"button\" value=\"Uloguj se\" id=\"logovanjeButton\" /></td>";
                            UserView += "    </tr>";

                            UserView += "</table>";

                            sessionStorage.setItem("trenutniPrikaz", UserView);
                            $("#PageContent").html(UserView);
                        }
                        
                    });

                } else
                {
                    $("#Greske").html("Sva polja moraju biti popunjena!");
                }
            });

            $(document).on("click", "#opcije", function () {
                $("#Greske").empty();
                $("#AllGood").empty();
                if (trenutnoUlogovan.Uloga == 0) {
                    // KORISNIK 
                    UserView = " <br/> ";
                    UserView += "    <table border=\"1\">";
                    UserView += "        <tr> <th> Start </th> <th> Odredište </th> <th> Mušterija </th> <th> Vozač </th> <th> Dispečer </th> <th> Status vožnje </th> <th> </th> <th> </th> </tr>";

                    for (v in trenutnoUlogovan.Voznje) {
                        UserView += "   <tr> <td> " + trenutnoUlogovan.Voznje[v] + " </td> <td>" + trenutnoUlogovan.Voznje[v].Odrediste + " </td> <td>" + trenutnoUlogovan.Voznje[v].Musterija.Name + " " + trenutnoUlogovan.Voznje[v].Musterija.LastName + "  </td > <td> " + trenutnoUlogovan.Voznje[v].Name + " " + trenutnoUlogovan.Voznje[v].Vozac.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].Dispatcher.Name + " " + trenutnoUlogovan.Voznje[v].Dispatcher.LastName + "</td> <td>" + trenutnoUlogovan.Voznje[v].StatusVoznje + " </td> <td> <input type=\"submit\" value=\"Izmeni\" id=\"izmenivoznju\" /> </td> <td> <input type=\"submit\" value=\"Pregledaj\" id=\"pregledajvoznju\" /> </td>  </tr > ";
                    }
                    UserView += "    </table>";
                    //UserView += "    <input type=\"submit\" value=\"Voznje na čekanju\" id=\"voznjeNaCekanju\"/>"; ovo vidi vozaccc
                    UserView += " <p> Pretraga po statusu </p>";
                    UserView += "<select name=\"vrsteVoznji\" size=\"1\">";
                    UserView += "   <option value=\"1\">KREIRANA</option>";
                    UserView += "    <option value=\"2\">FORMIRANA</option>";
                    UserView += "    <option value=\"3\">OBRADJENA</option>";
                    UserView += "    <option value=\"4\">PRIHVACENA</option>";
                    UserView += "    <option value=\"5\">OTKAZANA</option>";
                    UserView += "    <option value=\"6\">NEUSPESNA</option>";
                    UserView += "    <option value=\"8\">USPESNA</option>";
                    UserView += "    <option value=\"8\">U_TOKU</option>";
                    UserView += "</select> <br/> <br/>";

                    UserView += " <input value=\"Sortiranje po Datumu\" id=\"dateSort\" type=\"submit\" /> <br />";
                    UserView += "    <input value=\"Sortiranje po Oceni   \" id=\"gradeSort\" type=\"submit\" /> <br />";

                    UserView += "    <br/> Pretražite po datumu <br/> ";

                    UserView += "Početni datum: <input id=\"startdateSort\" type=\"datetime-local\" /> <br />";
                    UserView += "Krajnji datum: &nbsp;<input id=\"enddateSort\" type=\"datetime-local\" /> <br />";
                    UserView += "    <input type=\"submit\" id=\"searchByDate\" value=\"Pretraži\" /> <br/>";

                    UserView += "     <br/>Pretražite po oceni <br/> ";
                    UserView += "     Minimalna ocena: &nbsp;&nbsp;&nbsp;&nbsp;  ";

                    UserView += "   <select name=\"OceneMin\" size=\"1\">";
                    UserView += "        <option value=\"0\">0</option>";
                    UserView += "        <option value=\"1\">1</option>";
                    UserView += "        <option value=\"2\">2</option>";
                    UserView += "        <option value=\"3\">3</option>";
                    UserView += "        <option value=\"4\">4</option>";
                    UserView += "        <option value=\"5\">5</option>";
                    UserView += "    </select> <br/>";

                    UserView += "     Maksimalna ocena: &nbsp;&nbsp;   ";

                    UserView += "    <select name=\"OceneMax\" size=\"1\">";
                    UserView += "        <option value=\"0\">0</option>";
                    UserView += "         <option value=\"1\">1</option>";
                    UserView += "        <option value=\"2\">2</option>";
                    UserView += "        <option value=\"3\">3</option>";
                    UserView += "        <option value=\"4\">4</option>";
                    UserView += "        <option value=\"5\">5</option>";
                    UserView += "    </select> <br/>";

                    UserView += "     <input type=\"submit\" id=\"searchByGrade\" value=\"Pretraži\" />";

                    UserView += "   <p> <br/>Pretraga po ceni </p>";
                    UserView += "    Minimalna cena: &nbsp;&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";
                    UserView += "    Maksimalna cena:&nbsp; <input type=\"text\" id=\"searchByDate\" /> <br />";

                    UserView += "    <input type=\"submit\" id=\"searchByPrice\" value=\"Pretraži\" />";

                    var UserMenu = "<table align=\"center\">";
                    UserMenu += "  <tr> ";
                    UserMenu += "        <td id=\"opcije\"> Opcije </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"profil\"> Pregled profila </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"profil\"> Nova vožnja </td>";
                    UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                    UserMenu += "        <td id=\"logout\"> Izloguj se </td>";
                    UserMenu += "    </tr>";
                    UserMenu += "</table>";

                    sessionStorage.setItem("trenutniPrikaz", UserView);
                    sessionStorage.setItem("trenutniMeni", UserMenu);

                    $("#PageContent").html(UserView);
                    $("#PageMenu").html(UserMenu);

                }
                else if (data.Uloga == 1) {
                    //  DRIVER

                }
                else if (data.Uloga == 2) {
                    // ADMIN
                }
            });

            $(document).on("click", "#profil", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                UserView = " <table>";
                UserView += " <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" value=" +trenutnoUlogovan.UserName+" /></td> </tr>";
                UserView += "   <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" value=" + trenutnoUlogovan.Password + " /> </td> </tr>";
                UserView += "    <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" value=" + trenutnoUlogovan.Name + " /></td> </tr>";
                UserView += "   <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" value=" + trenutnoUlogovan.LastName + " /> </td> </tr>";
                UserView += "   <tr> <td> Pol: </td> <td>";
                if (trenutnoUlogovan.Gender == 1) {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "            <option value=\"2\">Muško</option>";
                    UserView += "        </select>";
                } else {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"1\">Muško</option>";
                    UserView += "            <option value=\"2\">Žensko</option>";
                    UserView += "        </select>";
                }
                /*UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                UserView += "            <option value=\"1\">Žensko</option>";
                UserView += "            <option value=\"2\">Muško</option>";
                UserView += "        </select>";*/
                UserView += "    </td> </tr>";
                UserView += "    <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" value=" + trenutnoUlogovan.JMBG + " /> </td> </tr>";
                UserView += "    <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" value=" + trenutnoUlogovan.PhoneNumber + " /> </td> </tr>";
                UserView += "    <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" value=" + trenutnoUlogovan.Email + " /> </td> </tr>";
                UserView += "   <tr><td colspan='2' align='center'> <input type=\"submit\" value=\"Promeni\" id=\"promeniProfil\" /></td></tr>";
                UserView += " </table >";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

            $(document).on("click", "#promeniProfil", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                if ($("#korisnickoIme").val() != "" && $("#korisnickaLozinka").val() != ""
                    && $("#Ime").val() != "" && $("#Prezime").val() != "" && $("#korisnickiJMBG").val() != "" && $("#korisnickiTelefon").val() != "" && $("#korisnickiEmail").val() != "")
                {
                    var objekat = {
                        UserName: $("#korisnickoIme").val(), Password: $("#korisnickaLozinka").val(), Name: $("#Ime").val(), LastName: $("#Prezime").val(),
                        Gender: $("#pol").val(), JMBG: $("#korisnickiJMBG").val(), PhoneNumber: $("#korisnickiTelefon").val(), Email: $("#korisnickiEmail").val(), Id: trenutnoUlogovan.Id };
                        

                    $.get("/api/ahome/changeuser", objekat, function (data, status) {
                        if (data.UserName == null) {
                            $("#Greske").html(data);
                        } else {
                            trenutnoUlogovan = data;
                            $("#AllGood").html("Izmene izvršene");
                        }
                    });
                } else {

                    var Greska = "Izmena koju ste uneli nije moguca";
                    $("#Greske").html(Greska);
                }

            });

            $(document).on("click", "#logout", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                $.ajax({
                    url: "/api/ahome/logoutuser",
                    data: trenutnoUlogovan,
                    type: "DELETE"
                });
                trenutnoUlogovan = null;

                UserView = "<table>";
                UserView += "    <tr>";
                UserView += "        <td> Korisničko ime </td>";
                UserView += "        <td> <input type=\"text\" id=\"Username\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> Lozinka </td>";
                UserView += "        <td> <input type=\"password\" id=\"Password\" /> </td>";
                UserView += "    </tr>";
                UserView += "    <tr>";
                UserView += "        <td> <input type=\"button\" value=\"Uloguj se\" id=\"logovanjeButton\" /></td>";
                UserView += "    </tr>";
                UserView += "</table>";

                UserMenu = "<table align=\"center\"> ";
                UserMenu += "    <tr>";
                UserMenu += "        <td id=\"logovanje\"> Uloguj se </td>";
                UserMenu += "        <td>&nbsp; &nbsp; &nbsp;</td>";
                UserMenu += "        <td id=\"registracija\"> Registruj se </td>";
                UserMenu += "    </tr>";
                UserMenu += " </table>";

                sessionStorage.setItem("trenutniPrikaz", UserView);
                sessionStorage.setItem("trenutniMeni", UserMenu);

                $("#PageContent").html(UserView);
                $("#PageMenu").html(UserMenu);
            });

            $(document).on("click", "#profilVozaca", function () {
                $("#Greske").empty();
                $("#AllGood").empty();

                UserView = " <table>";
                UserView += " <tr> <td> Korisničko ime: </td> <td> <input type=\"text\" id=\"korisnickoIme\" value=" + trenutnoUlogovan.UserName + " /></td> </tr>";
                UserView += "   <tr> <td> Lozinka: </td> <td> <input type=\"password\" id=\"korisnickaLozinka\" value=" + trenutnoUlogovan.Password + " /> </td> </tr>";
                UserView += "    <tr> <td> Ime: </td> <td> <input type=\"text\" id=\"Ime\" value=" + trenutnoUlogovan.Name + " /></td> </tr>";
                UserView += "   <tr> <td> Prezime: </td> <td> <input type=\"text\" id=\"Prezime\" value=" + trenutnoUlogovan.LastName + " /> </td> </tr>";
                if (trenutnoUlogovan.Gender == 1) {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"1\">Žensko</option>";
                    UserView += "            <option value=\"2\">Muško</option>";
                    UserView += "        </select>";
                } else {
                    UserView += "   <tr> <td> Pol: </td> <td>";
                    UserView += "       <select name=\"Pol\" id=\"pol\" size=\"1\">";
                    UserView += "            <option value=\"1\">Muško</option>";
                    UserView += "            <option value=\"2\">Žensko</option>";
                    UserView += "        </select>";
                }
                UserView += "    </td> </tr>";
                UserView += "    <tr> <td> JMBG: </td> <td> <input type=\"text\" id=\"korisnickiJMBG\" value=" + trenutnoUlogovan.JMBG + " /> </td> </tr>";
                UserView += "    <tr> <td> Kontakt telefon: </td> <td> <input type=\"text\" id=\"korisnickiTelefon\" value=" + trenutnoUlogovan.PhoneNumber + " /> </td> </tr>";
                UserView += "    <tr> <td> Email: </td> <td> <input type=\"text\" id=\"korisnickiEmail\" value=" + trenutnoUlogovan.Email + " /> </td> </tr>";
                // 
                UserView += "<tr> </td> <td> </td> <td></tr>";
                UserView += "<tr>";
                UserView += "    <td> Lokacija </td> <td> </td>";
                UserView += "</tr>";
                UserView += "     <tr> <td> Ulica i Broj: </td>  <td> " + trenutnoUlogovan.Lokacija.Adresa.UlicaBroj + " </td> </tr>";
                UserView += "    <tr> <td> Mesto i Postanski broj: </td>  <td> " + trenutnoUlogovan.Lokacija.Adresa.MestoPostanski + " </td> </tr>";
                UserView += "    <tr> <td> Registracija </td> <td> <input type=\"text\" id=\"korisnickaRegistracija\" value=" + trenutnoUlogovan.Automobil.Registracija + " /> </td> </tr>";
                UserView += "    <tr> <td> Godište </td> <td> <input type=\"text\" id=\"korisnickoGodiste\" value=" + trenutnoUlogovan.Automobil.GodisteAutomobila + " /> </td> </tr>";
                UserView += "   <tr> <td> Tip vozila </td> <td>";
                if (trenutnoUlogovan.Automobil.TipAutomobila == 0) {
                    UserView += "            <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                    UserView += "                <option value=\"1\">putnicki</option>";
                    UserView += "<option value=\"2\">kombi</option>";
                } else {
                    UserView += "                    <select name=\"TipVozila\" id=\"TipVozila\" size=\"1\">";
                    UserView += "                        <option value=\"1\">kombi</option>";
                    UserView += "<option value=\"2\">putnicki</option>";
                }
                UserView += "</select>";
                UserView += "</td> </tr>";
                UserView += "   <tr><td colspan='2' align='center'> <input type=\"submit\" value=\"Promeni\" id=\"promeniProfil\" /></td></tr>";
                UserView += " </table >";
            
                sessionStorage.setItem("trenutniPrikaz", UserView);
                $("#PageContent").html(UserView);
            });

        });
    </script>
</head>




<body>
    <div class="Baner" id="PageBanner">
        Taksi služba
    </div>

    <div id="PageMenu" class="Meni">
        <table align="center">
            <tr>
                <td id="logovanje"> Uloguj se </td>
                <td>&nbsp; &nbsp; &nbsp;</td>
                <td id="registracija"> Registruj se </td>
            </tr>
        </table>
    </div>
    <br /><br /><br />

    <div id="PageContent">
        <table>
            <tr>
                <td> Korisničko ime </td>
                <td> <input type="text" id="Username" /> </td>
            </tr>
            <tr>
                <td> Lozinka </td>
                <td> <input type="password" id="Password" /> </td>
            </tr>
            <tr>
                <td> <input type="button" value="Uloguj se" id="logovanjeButton" /></td>
            </tr>
        </table>
    </div>

    <div id="Greske" class="Bad">
    </div>

    <div id="AllGood" class="Good">
    </div>


</body>
</html>

